rule CVE_2015_1701_Taihou : hardened
{
	meta:
		description = "CVE-2015-1701 compiled exploit code"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		author = "Florian Roth (Nextron Systems)"
		reference = "http://goo.gl/W4nU0q"
		date = "2015-05-13"
		hash1 = "90d17ebd75ce7ff4f15b2df951572653efe2ea17"
		hash2 = "acf181d6c2c43356e92d4ee7592700fa01e30ffb"
		hash3 = "b8aabe12502f7d55ae332905acee80a10e3bc399"
		hash4 = "d9989a46d590ebc792f14aa6fec30560dfe931b1"
		hash5 = "63d1d33e7418daf200dc4660fc9a59492ddd50d9"
		score = 70
		id = "58250e17-aa46-5451-ae6d-18fb4030f8df"

	strings:
		$s3 = {56 69 72 74 75 61 6c 50 72 6f 74 65 63 74}
		$s4 = {52 65 67 69 73 74 65 72 43 6c 61 73 73}
		$s5 = {4c 6f 61 64 49 63 6f 6e}
		$s6 = {50 73 4c 6f 6f 6b 75 70 50 72 6f 63 65 73 73 42 79 50 72 6f 63 65 73 73 49 64}
		$s7 = {4c 6f 61 64 4c 69 62 72 61 72 79 45 78 41}
		$s8 = {67 53 68 61 72 65 64 49 6e 66 6f}
		$w1 = {75 00 73 00 65 00 72 00 33 00 32 00 2e 00 64 00 6c 00 6c 00}
		$w2 = {6e 00 74 00 64 00 6c 00 6c 00}

	condition:
		uint16( 0 ) == 0x5a4d and filesize < 160KB and all of ( $s* ) and 1 of ( $w* )
}

