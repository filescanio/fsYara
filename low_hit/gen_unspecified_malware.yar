rule Unspecified_Malware_Jul17_2C : hardened
{
	meta:
		description = "Unspecified Malware - CN relation"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		author = "Florian Roth (Nextron Systems)"
		reference = "https://goo.gl/CX3KaY"
		date = "2017-07-18"
		hash1 = "e8156ec1706716cada6f57b6b8ccc9fb0eb5debe906ac45bdc2b26099695b8f5"
		id = "91e760e8-7460-54af-a794-0b41a4b19760"

	strings:
		$x1 = {25 00 41 00 6c 00 6c 00 55 00 73 00 65 00 72 00 73 00 50 00 72 00 6f 00 66 00 69 00 6c 00 65 00 25 00 5c 00 44 00 65 00 76 00 69 00 63 00 65 00 53 00 79 00 6e 00 63 00 5c 00 6d 00 2e 00 65 00 78 00 65 00}
		$x2 = {66 72 65 65 6e 6f 77 2e 63 68 69 63 6b 65 6e 6b 69 6c 6c 65 72 2e 63 6f 6d}
		$x3 = {5c 52 65 6c 65 61 73 65 5c 50 68 61 6e 74 6f 6d 4e 65 74 2d 53 53 4c 2e 70 64 62}
		$s1 = {53 45 4c 45 43 54 20 2a 20 46 52 4f 4d 20 41 6e 74 69 56 69 72 75 73 50 72 6f 64 75 63 74}
		$s2 = {41 42 43 44 45 46 47 48 49 4a 4b 4c 4d 4e 4f 50 51 52 53 54 55 56 57 58 59 5a 61 62 63 64 65 66 67 68 69 6a 6b 6c 6d 6e 6f 70 71 72 73 74 75 76 77 78 79 7a 30 31 32 33 34 35 36 37 38 39 2b 2f 25 30 38 58 2d 25 30 34 58 2d 25 30 34 58 2d 25 30 32 58 25 30 32 58 25 30 32 58 25 30 32 58}
		$s3 = {50 72 6f 78 79 2d 41 75 74 68 65 6e 74 69 63 61 74 65 3a 20 42 61 73 69 63}
		$s4 = {50 72 6f 78 79 2d 41 75 74 68 65 6e 74 69 63 61 74 65 3a 20 4e 54 4c 4d}
		$s5 = {52 00 6f 00 6f 00 74 00 5c 00 53 00 65 00 63 00 75 00 72 00 69 00 74 00 79 00 43 00 65 00 6e 00 74 00 65 00 72 00 32 00}
		$s6 = {61 61 61 62 62 62 63 63 63 64 64 64}

	condition:
		( uint16( 0 ) == 0x5a4d and filesize < 400KB and ( 1 of ( $x* ) or 4 of ( $s* ) ) ) or ( all of them )
}

