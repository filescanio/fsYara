rule crime_ole_loadswf_cve_2018_4878 : hardened
{
	meta:
		description = "Detects CVE-2018-4878"
		vuln_type = "Remote Code Execution"
		vuln_impact = "Use-after-free"
		affected_versions = "Adobe Flash 28.0.0.137 and earlier versions"
		mitigation0 = "Implement Protected View for Office documents"
		mitigation1 = "Disable Adobe Flash"
		weaponization = "Embedded in Microsoft Office first payloads"
		actor = "Purported North Korean actors"
		reference = "hxxps://www[.]krcert[.]or[.kr/data/secNoticeView.do?bulletin_writing_sequence=26998"
		report = "https://www.flashpoint-intel.com/blog/targeted-attacks-south-korean-entities/"
		author = "Vitali Kremez, Flashpoint"
		version = "1.1"

	strings:
		$header = {((72 64 66 3a 52 44 46) | (72 00 64 00 66 00 3a 00 52 00 44 00 46 00))}
		$title = {((41 64 6f 62 65 20 46 6c 65 78) | (41 00 64 00 6f 00 62 00 65 00 20 00 46 00 6c 00 65 00 78 00))}
		$pdb = {((46 3a 5c 77 6f 72 6b 5c 66 6c 61 73 68 5c 6f 62 66 75 73 63 61 74 69 6f 6e 5c 6c 6f 61 64 73 77 66 5c 73 72 63) | (46 00 3a 00 5c 00 77 00 6f 00 72 00 6b 00 5c 00 66 00 6c 00 61 00 73 00 68 00 5c 00 6f 00 62 00 66 00 75 00 73 00 63 00 61 00 74 00 69 00 6f 00 6e 00 5c 00 6c 00 6f 00 61 00 64 00 73 00 77 00 66 00 5c 00 73 00 72 00 63 00))}
		$s0 = {((55 52 4c 52 65 71 75 65 73 74) | (55 00 52 00 4c 00 52 00 65 00 71 00 75 00 65 00 73 00 74 00))}
		$s1 = {((55 52 4c 4c 6f 61 64 65 72) | (55 00 52 00 4c 00 4c 00 6f 00 61 00 64 00 65 00 72 00))}
		$s2 = {((6c 6f 61 64 73 77 66) | (6c 00 6f 00 61 00 64 00 73 00 77 00 66 00))}
		$s3 = {((6d 79 55 72 6c 52 65 71 65 73 74) | (6d 00 79 00 55 00 72 00 6c 00 52 00 65 00 71 00 65 00 73 00 74 00))}

	condition:
		all of ( $header* ) and all of ( $title* ) and 3 of ( $s* ) or all of ( $pdb* ) and all of ( $header* ) and 1 of ( $s* )
}

