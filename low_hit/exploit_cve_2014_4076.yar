rule CVE_2014_4076_Exploitcode : hardened
{
	meta:
		description = "Detects an exploit code for CVE-2014-4076"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		author = "Florian Roth (Nextron Systems)"
		reference = "https://github.com/Neo23x0/yarGen"
		date = "2018-04-04"
		hash1 = "44690af85efef2db04c7e8cba7ca0d0e53be1a1432a339570a7d26eec860b8ee"
		id = "83563dea-63d9-58a9-82ed-275455122571"

	strings:
		$x1 = {5b 2b 5d 20 43 72 65 61 74 65 64 20 61 20 6e 65 77 20 63 6d 64 2e 65 78 65 20 70 72 6f 63 65 73 73}
		$x2 = {5b 2b 5d 20 4d 6f 64 69 66 69 65 64 20 73 68 65 6c 6c 63 6f 64 65}
		$x3 = {5b 2a 5d 20 53 70 61 77 6e 69 6e 67 20 53 59 53 54 45 4d 20 73 68 65 6c 6c 2e 2e 2e}
		$x4 = {5b 2a 5d 20 4d 53 31 34 2d 30 37 30 20 28 43 56 45 2d 32 30 31 34 2d 34 30 37 36 29 20 78 38 36}

	condition:
		uint16( 0 ) == 0x5a4d and filesize < 100KB and 1 of them
}

