rule HKTL_LazyCat_LogEraser : hardened loosened limited
{
	meta:
		description = "Detetcs a tool used in the Australian Parliament House network compromise"
		author = "Florian Roth (Nextron Systems)"
		reference = "https://twitter.com/cyb3rops/status/1097423665472376832"
		date = "2019-02-18"
		hash1 = "1c113dce265e4d744245a7c55dadc80199ae972a9e0ecbd0c5ced57067cf755b"
		hash2 = "510375f8142b3651df67d42c3eff8d2d880987c0e057fc75a5583f36de34bf0e"
		id = "a3d74657-a389-5482-ab26-966e790afd50"

	strings:
		$x1 = {((4c 61 7a 79 43 61 74 2e 64 6c 6c) | (4c 00 61 00 7a 00 79 00 43 00 61 00 74 00 2e 00 64 00 6c 00 6c 00))}
		$x2 = {((2e 6c 6f 63 61 6c 5f 70 72 69 76 69 6c 65 67 65 5f 65 73 63 61 6c 61 74 69 6f 6e 2e 72 6f 74 74 65 6e 5f 70 6f 74 61 74 6f) | (2e 00 6c 00 6f 00 63 00 61 00 6c 00 5f 00 70 00 72 00 69 00 76 00 69 00 6c 00 65 00 67 00 65 00 5f 00 65 00 73 00 63 00 61 00 6c 00 61 00 74 00 69 00 6f 00 6e 00 2e 00 72 00 6f 00 74 00 74 00 65 00 6e 00 5f 00 70 00 6f 00 74 00 61 00 74 00 6f 00))}
		$x3 = {((4c 61 7a 79 43 61 74 2e 45 78 74 65 6e 73 69 6f 6e) | (4c 00 61 00 7a 00 79 00 43 00 61 00 74 00 2e 00 45 00 78 00 74 00 65 00 6e 00 73 00 69 00 6f 00 6e 00))}
		$x4 = {((20 4d 45 4f 57 6f 66) | (20 00 4d 00 45 00 4f 00 57 00 6f 00 66 00))}
		$x5 = {(bf 00 | a1 00 | 21 00 | 22 00 | 23 00 | 24 00 | 25 00 | 26 00 | 27 00 | 28 00 | 29 00 | 2a 00 | 2b 00 | 2c 00 | 2d 00 | 2e 00 | 2f 00 | 3a 00 | 3b 00 | 3c 00 | 3d 00 | 3e 00 | 3f 00 | 40 00 | 5b 00 | 5c 00 | 5d 00 | 5e 00 | 5f 00 | 60 00 | 7b 00 | 7c 00 | 7d 00 | 7e 00 | 20 00 | 09 00 | 0a 00 | 0d 00 | 0b 00 | 0c 00 | 00 00 | ff) 56 00 69 00 72 00 74 00 75 00 61 00 6c 00 53 00 69 00 74 00 65 00 3a 00 20 00 7b 00 30 00 7d 00 2c 00 20 00 41 00 64 00 64 00 72 00 65 00 73 00 73 00 3a 00 20 00 7b 00 31 00 3a 00 58 00 31 00 36 00 7d 00 2c 00 20 00 4e 00 61 00 6d 00 65 00 3a 00 20 00 7b 00 32 00 7d 00 2c 00 20 00 48 00 61 00 6e 00 64 00 6c 00 65 00 3a 00 20 00 7b 00 33 00 3a 00 58 00 31 00 36 00 7d 00 2c 00 20 00 4c 00 6f 00 67 00 50 00 61 00 74 00 68 00 3a 00 20 00 7b 00 34 00 7d 00 (bf 00 | a1 00 | 21 00 | 22 00 | 23 00 | 24 00 | 25 00 | 26 00 | 27 00 | 28 00 | 29 00 | 2a 00 | 2b 00 | 2c 00 | 2d 00 | 2e 00 | 2f 00 | 3a 00 | 3b 00 | 3c 00 | 3d 00 | 3e 00 | 3f 00 | 40 00 | 5b 00 | 5c 00 | 5d 00 | 5e 00 | 5f 00 | 60 00 | 7b 00 | 7c 00 | 7d 00 | 7e 00 | 20 00 | 09 00 | 0a 00 | 0d 00 | 0b 00 | 0c 00 | 00 00 | ff)}
		$s1 = {((4c 61 7a 79 43 61 74) | (4c 00 61 00 7a 00 79 00 43 00 61 00 74 00))}
		$s2 = {24 65 33 66 66 33 37 66 32 2d 38 35 64 37 2d 34 62 32 34 2d 61 33 38 35 2d 37 65 65 62 31 66 35 61 39 35 36 32}
		$s3 = {6c 6f 63 61 6c 20 2d 3e 20 72 65 6d 6f 74 65 20 7b 30 7d 20 62 79 74 65 73}
		$s4 = {72 65 6d 6f 74 65 20 2d 3e 20 6c 6f 63 61 6c 20 7b 30 7d 20 62 79 74 65 73}

	condition:
		3 of them
}

rule HKTL_PowerKatz_Feb19_1 : hardened loosened limited
{
	meta:
		description = "Detetcs a tool used in the Australian Parliament House network compromise"
		author = "Florian Roth (Nextron Systems)"
		reference = "https://twitter.com/cyb3rops/status/1097423665472376832"
		date = "2019-02-18"
		id = "294d6f6c-dbc8-5431-87a0-64abe582c4ea"

	strings:
		$x1 = {((50 6f 77 65 72 6b 61 74 7a 33 32) | (50 00 6f 00 77 00 65 00 72 00 6b 00 61 00 74 00 7a 00 33 00 32 00))}
		$x2 = {((50 6f 77 65 72 6b 61 74 7a 36 34) | (50 00 6f 00 77 00 65 00 72 00 6b 00 61 00 74 00 7a 00 36 00 34 00))}
		$s1 = {((47 65 74 44 61 74 61 3a 20 6e 6f 74 20 66 6f 75 6e 64 20 74 61 73 6b 4e 61 6d 65) | (47 00 65 00 74 00 44 00 61 00 74 00 61 00 3a 00 20 00 6e 00 6f 00 74 00 20 00 66 00 6f 00 75 00 6e 00 64 00 20 00 74 00 61 00 73 00 6b 00 4e 00 61 00 6d 00 65 00))}
		$s2 = {((47 65 74 52 65 73 20 45 78 3a) | (47 00 65 00 74 00 52 00 65 00 73 00 20 00 45 00 78 00 3a 00))}

	condition:
		1 of ( $x* ) and 1 of ( $s* )
}

rule HKTL_Unknown_Feb19_1 : hardened loosened limited
{
	meta:
		description = "Detetcs a tool used in the Australian Parliament House network compromise"
		author = "Florian Roth (Nextron Systems)"
		reference = "https://twitter.com/cyb3rops/status/1097423665472376832"
		date = "2019-02-18"
		id = "bdcadc4b-8881-5dc7-b203-4e79cbc850ed"

	strings:
		$x1 = {((6e 6f 74 20 61 20 76 61 6c 69 64 20 74 69 6d 65 6f 75 74 20 66 6f 72 6d 61 74 21) | (6e 00 6f 00 74 00 20 00 61 00 20 00 76 00 61 00 6c 00 69 00 64 00 20 00 74 00 69 00 6d 00 65 00 6f 00 75 00 74 00 20 00 66 00 6f 00 72 00 6d 00 61 00 74 00 21 00))}
		$x2 = {((68 6f 73 74 20 63 61 6e 20 6e 6f 74 20 62 65 20 65 6d 70 74 79 21) | (68 00 6f 00 73 00 74 00 20 00 63 00 61 00 6e 00 20 00 6e 00 6f 00 74 00 20 00 62 00 65 00 20 00 65 00 6d 00 70 00 74 00 79 00 21 00))}
		$x3 = {((6e 6f 74 20 61 20 76 61 6c 69 64 20 70 6f 72 74 20 66 6f 72 6d 61 74 21) | (6e 00 6f 00 74 00 20 00 61 00 20 00 76 00 61 00 6c 00 69 00 64 00 20 00 70 00 6f 00 72 00 74 00 20 00 66 00 6f 00 72 00 6d 00 61 00 74 00 21 00))}
		$x4 = {((7b 30 7d 20 2d 20 7b 31 7d 20 54 54 4c 3d 7b 32 7d 20 74 69 6d 65 3d 7b 33 7d) | (7b 00 30 00 7d 00 20 00 2d 00 20 00 7b 00 31 00 7d 00 20 00 54 00 54 00 4c 00 3d 00 7b 00 32 00 7d 00 20 00 74 00 69 00 6d 00 65 00 3d 00 7b 00 33 00 7d 00))}
		$x5 = {((70 69 6e 67 20 63 6f 75 6e 74 20 69 73 20 6e 6f 74 20 61 20 63 6f 72 72 65 63 74 20 66 6f 72 6d 61 74 21) | (70 00 69 00 6e 00 67 00 20 00 63 00 6f 00 75 00 6e 00 74 00 20 00 69 00 73 00 20 00 6e 00 6f 00 74 00 20 00 61 00 20 00 63 00 6f 00 72 00 72 00 65 00 63 00 74 00 20 00 66 00 6f 00 72 00 6d 00 61 00 74 00 21 00))}
		$s1 = {((54 68 65 20 72 65 73 75 6c 74 20 69 73 20 74 6f 6f 20 6c 61 72 67 65 2c 70 72 6f 67 72 61 6d 20 73 74 6f 72 65 20 74 6f 20 27 7b 30 7d 27 2e 50 6c 65 61 73 65 20 64 6f 77 6e 6c 6f 61 64 20 69 74 20 6d 61 6e 75 6c 6c 79 2e) | (54 00 68 00 65 00 20 00 72 00 65 00 73 00 75 00 6c 00 74 00 20 00 69 00 73 00 20 00 74 00 6f 00 6f 00 20 00 6c 00 61 00 72 00 67 00 65 00 2c 00 70 00 72 00 6f 00 67 00 72 00 61 00 6d 00 20 00 73 00 74 00 6f 00 72 00 65 00 20 00 74 00 6f 00 20 00 27 00 7b 00 30 00 7d 00 27 00 2e 00 50 00 6c 00 65 00 61 00 73 00 65 00 20 00 64 00 6f 00 77 00 6e 00 6c 00 6f 00 61 00 64 00 20 00 69 00 74 00 20 00 6d 00 61 00 6e 00 75 00 6c 00 6c 00 79 00 2e 00))}
		$s2 = {((43 3a 5c 57 69 6e 64 6f 77 73 5c 74 65 6d 70 5c) | (43 00 3a 00 5c 00 57 00 69 00 6e 00 64 00 6f 00 77 00 73 00 5c 00 74 00 65 00 6d 00 70 00 5c 00))}

	condition:
		1 of ( $x* ) or 2 of them
}

