rule FiveEyes_QUERTY_Malwareqwerty_20121 : hardened
{
	meta:
		description = "FiveEyes QUERTY Malware - file 20121.xml"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		author = "Florian Roth (Nextron Systems)"
		reference = "http://www.spiegel.de/media/media-35668.pdf"
		date = "2015/01/18"
		hash = "8263fb58350f3b1d3c4220a602421232d5e40726"
		id = "bf30bdbb-0153-5ae2-bf42-4bd9e4a2f088"

	strings:
		$s0 = {3c 63 6f 6e 66 69 67 46 69 6c 65 4e 61 6d 65 3e 32 30 31 32 31 5f 63 6d 64 44 65 66 2e 78 6d 6c 3c 2f 63 6f 6e 66 69 67 46 69 6c 65 4e 61 6d 65 3e}
		$s1 = {3c 6e 61 6d 65 3e 32 30 31 32 31 2e 64 6c 6c 3c 2f 6e 61 6d 65 3e}
		$s2 = {3c 63 6f 64 65 62 61 73 65 3e 22 52 65 73 65 72 76 65 64 20 66 6f 72 20 66 75 74 75 72 65 20 75 73 65 2e 22 3c 2f 63 6f 64 65 62 61 73 65 3e}
		$s3 = {3c 70 6c 75 67 69 6e 20 78 6d 6c 6e 73 3a 78 73 69 3d 22 68 74 74 70 3a 2f 2f 77 77 77 2e 77 33 2e 6f 72 67 2f 32 30 30 31 2f 58 4d 4c 53 63 68 65 6d 61 2d 69 6e 73 74 61 6e 63 65 22 20 78 73 69 3a 6e 6f 4e 61 6d 65 73 70 61 63 65 53}
		$s4 = {3c 70 6c 61 74 66 6f 72 6d 20 74 79 70 65 3d 22 31 22 3e}
		$s5 = {3c 2f 70 6c 75 67 69 6e 3e}
		$s6 = {3c 2f 70 6c 75 67 69 6e 43 6f 6e 66 69 67 3e}
		$s7 = {3c 70 6c 75 67 69 6e 43 6f 6e 66 69 67 3e}
		$s8 = {3c 2f 70 6c 61 74 66 6f 72 6d 3e}
		$s9 = {3c 2f 6c 70 43 6f 6e 66 69 67 3e}
		$s10 = {3c 6c 70 43 6f 6e 66 69 67 3e}

	condition:
		9 of them
}

rule FiveEyes_QUERTY_Malwaresig_20123_sys : hardened
{
	meta:
		description = "FiveEyes QUERTY Malware - file 20123.sys.bin"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		author = "Florian Roth (Nextron Systems)"
		reference = "http://www.spiegel.de/media/media-35668.pdf"
		date = "2015/01/18"
		hash = "a0f0087bd1f8234d5e847363d7e15be8a3e6f099"
		id = "0d0e3642-f5d4-59b2-8e56-a7c999e34775"

	strings:
		$s0 = {32 30 31 32 33 2e 64 6c 6c}
		$s1 = {6b 00 62 00 64 00 63 00 6c 00 61 00 73 00 73 00 2e 00 73 00 79 00 73 00}
		$s2 = {49 6f 46 72 65 65 4d 64 6c}
		$s3 = {6e 74 6f 73 6b 72 6e 6c 2e 65 78 65}
		$s4 = {4b 66 52 65 6c 65 61 73 65 53 70 69 6e 4c 6f 63 6b}

	condition:
		all of them
}

rule FiveEyes_QUERTY_Malwaresig_20123_cmdDef : hardened
{
	meta:
		description = "FiveEyes QUERTY Malware - file 20123_cmdDef.xml"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		author = "Florian Roth (Nextron Systems)"
		reference = "http://www.spiegel.de/media/media-35668.pdf"
		date = "2015/01/18"
		hash = "7b08fc77629f6caaf8cc4bb5f91be6b53e19a3cd"
		id = "88a29288-9db5-5437-9efe-cdb823a2b928"

	strings:
		$s0 = {3c 73 68 6f 72 74 44 65 73 63 72 69 70 74 69 6f 6e 3e 4b 65 79 73 74 72 6f 6b 65 20 43 6f 6c 6c 65 63 74 6f 72 3c 2f 73 68 6f 72 74 44 65 73 63 72 69 70 74 69 6f 6e 3e}
		$s1 = {54 68 69 73 20 70 6c 75 67 69 6e 20 69 73 20 74 68 65 20 45 5f 51 77 65 72 74 79 20 4b 65 72 6e 65 6c 20 4d 6f 64 65 20 64 72 69 76 65 72 20 66 6f 72 20 6c 6f 67 67 69 6e 67 20 6b 65 79 73 2e 3c 2f 64 65 73 63 72 69 70 74 69 6f 6e 3e}
		$s2 = {3c 63 6f 6d 6d 61 6e 64 73 2f 3e}
		$s3 = {3c 2f 76 65 72 73 69 6f 6e 3e}
		$s4 = {3c 61 73 73 6f 63 69 61 74 65 64 49 6d 70 6c 61 6e 74 49 64 3e 32 30 31 32 31 3c 2f 61 73 73 6f 63 69 61 74 65 64 49 6d 70 6c 61 6e 74 49 64 3e}
		$s5 = {3c 72 69 67 68 74 73 52 65 71 75 69 72 65 64 3e 53 79 73 74 65 6d 20 6f 72 20 41 64 6d 69 6e 69 73 74 72 61 74 6f 72 20 28 69 66 20 41 64 6d 69 6e 69 73 74 72 61 74 6f 72 2c 20 49 20 74 68 69 6e 6b 20 74 68 65 20 44 72 69 76 65 72 49 6e 73}
		$s6 = {3c 70 6c 61 74 66 6f 72 6d 73 3e 57 69 6e 64 6f 77 73 20 4e 54 2c 20 57 69 6e 64 6f 77 73 20 32 30 30 30 2c 20 57 69 6e 64 6f 77 73 20 58 50 20 28 33 32 2f 36 34 20 62 69 74 29 2c 20 57 69 6e 64 6f 77 73 20 32 30 30 33 20 28 33 32 2f 36 34}
		$s7 = {3c 70 72 6f 6a 65 63 74 70 61 74 68 3e 70 6c 75 67 69 6e 2f 43 6f 6c 6c 65 63 74 69 6f 6e 3c 2f 70 72 6f 6a 65 63 74 70 61 74 68 3e}
		$s8 = {3c 64 6c 6c 44 65 70 65 6e 64 3e 4e 6f 6e 65 3c 2f 64 6c 6c 44 65 70 65 6e 64 3e}
		$s9 = {3c 6d 69 6e 6f 72 54 79 70 65 3e 30 3c 2f 6d 69 6e 6f 72 54 79 70 65 3e}
		$s10 = {3c 70 6c 75 67 69 6e 6e 61 6d 65 3e 45 5f 51 77 65 72 74 79 4b 4d 3c 2f 70 6c 75 67 69 6e 6e 61 6d 65 3e}
		$s11 = {3c 2f 63 6f 6d 6d 65 6e 74 73 3e}
		$s12 = {3c 63 6f 6d 6d 65 6e 74 73 3e}
		$s13 = {3c 6d 61 6a 6f 72 54 79 70 65 3e 31 3c 2f 6d 61 6a 6f 72 54 79 70 65 3e}
		$s14 = {3c 66 69 6c 65 73 3e 4e 6f 6e 65 3c 2f 66 69 6c 65 73 3e}
		$s15 = {3c 70 6f 63 3e 45 72 65 62 75 73 3c 2f 70 6f 63 3e}
		$s16 = {3c 2f 70 6c 75 67 69 6e 3e}
		$s17 = {3c 74 65 61 6d 3e 4e 6f 6e 65 3c 2f 74 65 61 6d 3e}
		$s18 = {3c 3f 78 6d 6c 2d 73 74 79 6c 65 73 68 65 65 74 20 74 79 70 65 3d 22 74 65 78 74 2f 78 73 6c 22 20 68 72 65 66 3d 22 2e 2e 2f 58 53 4c 54 2f 70 6c 75 67 69 6e 48 54 4d 4c 2e 78 73 6c 22 3f 3e}
		$s19 = {3c 70 6c 75 67 69 6e 73 44 65 70 65 6e 64 3e 55 5f 48 6f 6f 6b 4d 61 6e 61 67 65 72 20 76 31 2e 30 2c 20 4b 65 72 6e 65 6c 20 43 6f 76 65 72 74 20 53 74 6f 72 65 20 76 31 2e 30 3c 2f 70 6c 75 67 69 6e 73 44 65 70 65 6e 64 3e}
		$s20 = {3c 70 6c 75 67 69 6e 20 69 64 3d 22 32 30 31 32 33 22 20 78 6d 6c 6e 73 3a 78 73 69 3d 22 68 74 74 70 3a 2f 2f 77 77 77 2e 77 33 2e 6f 72 67 2f 32 30 30 31 2f 58 4d 4c 53 63 68 65 6d 61 2d 69 6e 73 74 61 6e 63 65 22 20 78 73 69}

	condition:
		14 of them
}

rule FiveEyes_QUERTY_Malwaresig_20121_dll : hardened
{
	meta:
		description = "FiveEyes QUERTY Malware - file 20121.dll.bin"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		author = "Florian Roth (Nextron Systems)"
		reference = "http://www.spiegel.de/media/media-35668.pdf"
		date = "2015/01/18"
		hash = "89504d91c5539a366e153894c1bc17277116342b"
		id = "a0dc146c-85fd-55b8-a5e0-bfc1f406507e"

	strings:
		$s0 = {57 61 72 72 69 6f 72 50 72 69 64 65 5c 70 72 6f 64 75 63 74 69 6f 6e 32 2e 30 5c 70 61 63 6b 61 67 65 5c 45 5f 57 7a 6f 77 73 6b 69}
		$s1 = {32 30 31 32 31 2e 64 6c 6c}

	condition:
		all of them
}

rule FiveEyes_QUERTY_Malwareqwerty_20123 : hardened
{
	meta:
		description = "FiveEyes QUERTY Malware - file 20123.xml"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		author = "Florian Roth (Nextron Systems)"
		reference = "http://www.spiegel.de/media/media-35668.pdf"
		date = "2015/01/18"
		hash = "edc7228b2e27df9e7ff9286bddbf4e46adb51ed9"
		id = "718d80c9-b6bb-5b73-9c17-49e7d6f77210"

	strings:
		$s0 = {3c 21 2d 2d 20 65 64 69 74 65 64 20 77 69 74 68 20 58 4d 4c 53 50 59 20 76 35 20 72 65 6c 2e 20 34 20 55 20 28 68 74 74 70 3a 2f 2f 77 77 77 2e 78 6d 6c 73 70 79 2e 63 6f 6d 29 20 62 79 20 54 45 41 4d 20 28 52 45 4e 45 47 41 44 45 29 20 2d}
		$s1 = {3c 63 6f 6e 66 69 67 46 69 6c 65 4e 61 6d 65 3e 32 30 31 32 33 5f 63 6d 64 44 65 66 2e 78 6d 6c 3c 2f 63 6f 6e 66 69 67 46 69 6c 65 4e 61 6d 65 3e}
		$s2 = {3c 6e 61 6d 65 3e 32 30 31 32 33 2e 73 79 73 3c 2f 6e 61 6d 65 3e}
		$s3 = {3c 70 6c 75 67 69 6e 20 78 6d 6c 6e 73 3a 78 73 69 3d 22 68 74 74 70 3a 2f 2f 77 77 77 2e 77 33 2e 6f 72 67 2f 32 30 30 31 2f 58 4d 4c 53 63 68 65 6d 61 2d 69 6e 73 74 61 6e 63 65 22 20 78 73 69 3a 6e 6f 4e 61 6d 65 73 70 61 63 65 53}
		$s4 = {3c 63 6f 64 65 62 61 73 65 3e 2f 62 69 6e 2f 69 36 38 36 2d 70 63 2d 77 69 6e 33 32 2f 64 65 62 75 67 3c 2f 63 6f 64 65 62 61 73 65 3e}
		$s5 = {3c 70 6c 61 74 66 6f 72 6d 20 74 79 70 65 3d 22 31 22 3e}
		$s6 = {3c 2f 70 6c 75 67 69 6e 3e}
		$s7 = {3c 2f 70 6c 75 67 69 6e 43 6f 6e 66 69 67 3e}
		$s8 = {3c 70 6c 75 67 69 6e 43 6f 6e 66 69 67 3e}
		$s9 = {3c 2f 70 6c 61 74 66 6f 72 6d 3e}
		$s10 = {3c 2f 6c 70 43 6f 6e 66 69 67 3e}
		$s11 = {3c 6c 70 43 6f 6e 66 69 67 3e}

	condition:
		9 of them
}

rule FiveEyes_QUERTY_Malwaresig_20120_dll : hardened
{
	meta:
		description = "FiveEyes QUERTY Malware - file 20120.dll.bin"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		author = "Florian Roth (Nextron Systems)"
		reference = "http://www.spiegel.de/media/media-35668.pdf"
		date = "2015/01/18"
		hash = "6811bfa3b8cda5147440918f83c40237183dbd25"
		id = "d23ac7bf-3e0c-5b59-a9dc-1ae0a4ae9c02"

	strings:
		$s0 = {5c 00 51 00 77 00 4c 00 6f 00 67 00 5f 00 25 00 64 00 2d 00 25 00 30 00 32 00 64 00 2d 00 25 00 30 00 32 00 64 00 2d 00 25 00 30 00 32 00 64 00 25 00 30 00 32 00 64 00 25 00 30 00 32 00 64 00 2e 00 74 00 78 00 74 00}
		$s1 = {5c 00 51 00 77 00 4c 00 6f 00 67 00 5f 00 25 00 64 00 2d 00 25 00 30 00 32 00 64 00 2d 00 25 00 30 00 32 00 64 00 2d 00 25 00 30 00 32 00 64 00 25 00 30 00 32 00 64 00 25 00 30 00 32 00 64 00 2e 00 78 00 6d 00 6c 00}
		$s2 = {46 61 69 6c 65 64 20 74 6f 20 73 65 6e 64 20 74 68 65 20 45 51 77 65 72 74 79 5f 64 72 69 76 65 72 53 74 61 74 75 73 43 6f 6d 6d 61 6e 64 20 74 6f 20 74 68 65 20 69 6d 70 6c 61 6e 74 2e}
		$s3 = {2d 00 20 00 4c 00 6f 00 67 00 20 00 55 00 73 00 65 00 64 00 20 00 28 00 6e 00 75 00 6d 00 62 00 65 00 72 00 20 00 6f 00 66 00 20 00 77 00 69 00 6e 00 64 00 6f 00 77 00 73 00 29 00 20 00 2d 00 20 00 25 00 64 00}
		$s4 = {2d 00 20 00 4c 00 6f 00 67 00 20 00 4c 00 69 00 6d 00 69 00 74 00 20 00 28 00 6e 00 75 00 6d 00 62 00 65 00 72 00 20 00 6f 00 66 00 20 00 77 00 69 00 6e 00 64 00 6f 00 77 00 73 00 29 00 20 00 2d 00 20 00 25 00 64 00}
		$s5 = {50 00 72 00 6f 00 63 00 65 00 73 00 73 00 20 00 6f 00 72 00 20 00 55 00 73 00 65 00 72 00 20 00 44 00 65 00 66 00 61 00 75 00 6c 00 74 00 20 00 4c 00 61 00 6e 00 67 00 75 00 61 00 67 00 65 00}
		$s6 = {57 00 69 00 6e 00 64 00 6f 00 77 00 73 00 20 00 39 00 38 00 2f 00 4d 00 65 00 2c 00 20 00 57 00 69 00 6e 00 64 00 6f 00 77 00 73 00 20 00 4e 00 54 00 20 00 34 00 2e 00 30 00 20 00 61 00 6e 00 64 00 20 00 6c 00 61 00 74 00 65 00 72 00 3a 00 20 00 56 00 69 00 65 00 74 00 6e 00 61 00 6d 00 65 00 73 00 65 00}
		$s7 = {2d 00 20 00 4c 00 6f 00 67 00 67 00 69 00 6e 00 67 00 20 00 6f 00 66 00 20 00 6b 00 65 00 79 00 73 00 74 00 72 00 6f 00 6b 00 65 00 73 00 20 00 69 00 73 00 20 00 73 00 77 00 69 00 74 00 63 00 68 00 65 00 64 00 20 00 4f 00 4e 00}
		$s8 = {2d 00 20 00 4c 00 6f 00 67 00 67 00 69 00 6e 00 67 00 20 00 6f 00 66 00 20 00 6b 00 65 00 79 00 73 00 74 00 72 00 6f 00 6b 00 65 00 73 00 20 00 69 00 73 00 20 00 73 00 77 00 69 00 74 00 63 00 68 00 65 00 64 00 20 00 4f 00 46 00 46 00}
		$s9 = {51 00 77 00 65 00 72 00 74 00 79 00 20 00 69 00 73 00 20 00 63 00 75 00 72 00 72 00 65 00 6e 00 74 00 6c 00 79 00 20 00 6c 00 6f 00 67 00 67 00 69 00 6e 00 67 00 20 00 61 00 63 00 74 00 69 00 76 00 65 00 20 00 77 00 69 00 6e 00 64 00 6f 00 77 00 73 00 20 00 77 00 69 00 74 00 68 00 20 00 74 00 69 00 74 00 6c 00 65 00 73 00 20 00 63 00 6f 00 6e 00 74 00 61 00 69 00 6e 00 69 00 6e 00 67 00 20 00 74 00 68 00 65 00 20 00 66 00 6f 00}
		$s10 = {57 00 69 00 6e 00 64 00 6f 00 77 00 73 00 20 00 39 00 35 00 2c 00 20 00 57 00 69 00 6e 00 64 00 6f 00 77 00 73 00 20 00 4e 00 54 00 20 00 34 00 2e 00 30 00 20 00 6f 00 6e 00 6c 00 79 00 3a 00 20 00 4b 00 6f 00 72 00 65 00 61 00 6e 00 20 00 28 00 4a 00 6f 00 68 00 61 00 62 00 29 00}
		$s11 = {46 00 41 00 49 00 4c 00 45 00 44 00 20 00 74 00 6f 00 20 00 67 00 65 00 74 00 20 00 51 00 77 00 65 00 72 00 74 00 79 00 20 00 53 00 74 00 61 00 74 00 75 00 73 00}
		$s12 = {2d 00 20 00 53 00 75 00 63 00 63 00 65 00 73 00 73 00 66 00 75 00 6c 00 6c 00 79 00 20 00 72 00 65 00 74 00 72 00 69 00 65 00 76 00 65 00 64 00 20 00 4c 00 6f 00 67 00 20 00 66 00 72 00 6f 00 6d 00 20 00 49 00 6d 00 70 00 6c 00 61 00 6e 00 74 00 2e 00}
		$s13 = {2d 00 20 00 4c 00 6f 00 67 00 67 00 69 00 6e 00 67 00 20 00 6f 00 66 00 20 00 61 00 6c 00 6c 00 20 00 57 00 69 00 6e 00 64 00 6f 00 77 00 73 00 20 00 69 00 73 00 20 00 74 00 6f 00 67 00 67 00 6c 00 65 00 64 00 20 00 4f 00 4e 00}
		$s14 = {2d 00 20 00 4c 00 6f 00 67 00 67 00 69 00 6e 00 67 00 20 00 6f 00 66 00 20 00 61 00 6c 00 6c 00 20 00 57 00 69 00 6e 00 64 00 6f 00 77 00 73 00 20 00 69 00 73 00 20 00 74 00 6f 00 67 00 67 00 6c 00 65 00 64 00 20 00 4f 00 46 00 46 00}
		$s15 = {51 00 77 00 65 00 72 00 74 00 79 00 20 00 46 00 41 00 49 00 4c 00 45 00 44 00 20 00 74 00 6f 00 20 00 72 00 65 00 74 00 72 00 69 00 65 00 76 00 65 00 20 00 77 00 69 00 6e 00 64 00 6f 00 77 00 20 00 6c 00 69 00 73 00 74 00 2e 00}
		$s16 = {2d 00 20 00 55 00 4e 00 53 00 55 00 43 00 43 00 45 00 53 00 53 00 46 00 55 00 4c 00 20 00 4c 00 6f 00 67 00 20 00 52 00 65 00 74 00 72 00 69 00 65 00 76 00 61 00 6c 00 20 00 66 00 72 00 6f 00 6d 00 20 00 49 00 6d 00 70 00 6c 00 61 00 6e 00 74 00 2e 00}
		$s17 = {54 68 65 20 69 6d 70 6c 61 6e 74 20 66 61 69 6c 65 64 20 74 6f 20 72 65 74 75 72 6e 20 61 20 76 61 6c 69 64 20 73 74 61 74 75 73}
		$s18 = {2d 00 20 00 4c 00 6f 00 67 00 20 00 66 00 69 00 6c 00 65 00 73 00 20 00 77 00 65 00 72 00 65 00 20 00 4e 00 4f 00 54 00 20 00 67 00 65 00 6e 00 65 00 72 00 61 00 74 00 65 00 64 00 21 00}
		$s19 = {57 00 69 00 6e 00 64 00 6f 00 77 00 73 00 20 00 32 00 30 00 30 00 30 00 2f 00 58 00 50 00 3a 00 20 00 41 00 72 00 6d 00 65 00 6e 00 69 00 61 00 6e 00 2e 00 20 00 54 00 68 00 69 00 73 00 20 00 69 00 73 00 20 00 55 00 6e 00 69 00 63 00 6f 00 64 00 65 00 20 00 6f 00 6e 00 6c 00 79 00 2e 00}
		$s20 = {2d 00 20 00 54 00 68 00 69 00 73 00 20 00 6d 00 61 00 63 00 68 00 69 00 6e 00 65 00 20 00 69 00 73 00 20 00 75 00 73 00 69 00 6e 00 67 00 20 00 61 00 20 00 50 00 53 00 2f 00 32 00 20 00 4b 00 65 00 79 00 62 00 6f 00 61 00 72 00 64 00 20 00 2d 00 20 00 43 00 6f 00 6e 00 74 00 69 00 6e 00 75 00 65 00 20 00 6f 00 6e 00 20 00 75 00 73 00 69 00 6e 00 67 00 20 00 51 00 57 00 45 00 52 00 54 00 59 00}

	condition:
		10 of them
}

rule FiveEyes_QUERTY_Malwaresig_20120_cmdDef : hardened
{
	meta:
		description = "FiveEyes QUERTY Malware - file 20120_cmdDef.xml"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		author = "Florian Roth (Nextron Systems)"
		reference = "http://www.spiegel.de/media/media-35668.pdf"
		date = "2015/01/18"
		hash = "cda9ceaf0a39d6b8211ce96307302a53dfbd71ea"
		id = "dfa0693e-4e4c-59c8-9e51-e221aefd8662"

	strings:
		$s0 = {54 68 69 73 20 50 50 43 20 67 65 74 73 20 74 68 65 20 63 75 72 72 65 6e 74 20 6b 65 79 73 74 72 6f 6b 65 20 6c 6f 67 2e}
		$s1 = {54 68 69 73 20 63 6f 6d 6d 61 6e 64 20 77 69 6c 6c 20 61 64 64 20 74 68 65 20 67 69 76 65 6e 20 57 69 6e 64 6f 77 54 69 74 6c 65 20 74 6f 20 74 68 65 20 6c 69 73 74 20 6f 66 20 57 69 6e 64 6f 77 73 20 74 6f 20 6c 6f 67 20 6b 65 79 73 20 66}
		$s2 = {54 68 69 73 20 63 6f 6d 6d 61 6e 64 20 77 69 6c 6c 20 72 65 6d 6f 76 65 20 74 68 65 20 57 69 6e 64 6f 77 54 69 74 6c 65 20 63 6f 72 72 65 73 70 6f 6e 64 69 6e 67 20 74 6f 20 74 68 65 20 67 69 76 65 6e 20 77 69 6e 64 6f 77 20 74 69 74 6c 65}
		$s3 = {54 68 69 73 20 63 6f 6d 6d 61 6e 64 20 77 69 6c 6c 20 72 65 74 75 72 6e 20 74 68 65 20 63 75 72 72 65 6e 74 20 73 74 61 74 75 73 20 6f 66 20 74 68 65 20 4b 65 79 62 6f 61 72 64 20 4c 6f 67 67 65 72 20 28 57 68 65 74 68 65 72 20 69 74 20 69}
		$s4 = {54 68 69 73 20 63 6f 6d 6d 61 6e 64 20 54 6f 67 67 6c 65 73 20 6c 6f 67 67 69 6e 67 20 6f 66 20 61 6c 6c 20 4b 65 79 73 2e 20 49 66 20 61 6c 6c 6b 65 79 73 20 69 73 20 74 6f 67 67 6c 65 64 20 61 6c 6c 20 6b 65 79 73 74 72 6f 6b 65 73 20 77}
		$s5 = {3c 64 65 66 69 6e 69 74 69 6f 6e 3e 54 75 72 6e 20 6c 6f 67 67 69 6e 67 20 6f 66 20 61 6c 6c 20 6b 65 79 73 20 6f 6e 7c 6f 66 66 3c 2f 64 65 66 69 6e 69 74 69 6f 6e 3e}
		$s6 = {3c 6e 61 6d 65 3e 47 65 74 20 4b 65 79 73 74 72 6f 6b 65 20 4c 6f 67 3c 2f 6e 61 6d 65 3e}
		$s7 = {3c 64 65 73 63 72 69 70 74 69 6f 6e 3e 4b 65 79 73 74 72 6f 6b 65 20 4c 6f 67 67 65 72 20 4c 70 20 50 6c 75 67 69 6e 3c 2f 64 65 73 63 72 69 70 74 69 6f 6e 3e}
		$s8 = {3c 64 65 66 69 6e 69 74 69 6f 6e 3e 64 69 73 70 6c 61 79 20 68 65 6c 70 20 66 6f 72 20 74 68 69 73 20 66 75 6e 63 74 69 6f 6e 3c 2f 64 65 66 69 6e 69 74 69 6f 6e 3e}
		$s9 = {54 68 69 73 20 63 6f 6d 6d 61 6e 64 20 77 69 6c 6c 20 73 77 69 74 63 68 20 4f 4e 20 4c 6f 67 67 69 6e 67 20 6f 66 20 6b 65 79 73 2e 20 41 6c 6c 20 6b 65 79 73 20 74 61 68 74 20 61 72 65 20 65 6e 74 65 72 65 64 20 74 6f 20 61 20 61 63 74 69}
		$s10 = {53 65 74 20 74 68 65 20 6c 6f 67 20 6c 69 6d 69 74 20 28 69 6e 20 6e 75 6d 62 65 72 20 6f 66 20 77 69 6e 64 6f 77 73 29}
		$s11 = {3c 65 78 61 6d 70 6c 65 3e 71 77 67 65 74 6c 6f 67 3c 2f 65 78 61 6d 70 6c 65 3e}
		$s12 = {3c 61 6c 69 61 73 4e 61 6d 65 3e 71 77 67 65 74 6c 6f 67 3c 2f 61 6c 69 61 73 4e 61 6d 65 3e}
		$s13 = {3c 64 65 66 69 6e 69 74 69 6f 6e 3e 54 68 65 20 74 69 74 6c 65 20 6f 66 20 74 68 65 20 57 69 6e 64 6f 77 20 77 68 6f 73 65 20 6b 65 79 73 20 79 6f 75 20 77 69 73 68 20 74 6f 20 4c 6f 67 20 6f 6e 63 65 20 69 74 20 62 65 63 6f 6d 65 73 20 61}
		$s14 = {54 68 69 73 20 63 6f 6d 6d 61 6e 64 20 77 69 6c 6c 20 73 77 69 74 63 68 20 4f 46 46 20 4c 6f 67 67 69 6e 67 20 6f 66 20 6b 65 79 73 2e 20 4e 6f 20 6b 65 79 73 74 72 6f 6b 65 73 20 77 69 6c 6c 20 62 65 20 63 61 70 74 75 72 65 64}
		$s15 = {3c 64 65 66 69 6e 69 74 69 6f 6e 3e 54 68 65 20 74 69 74 6c 65 20 6f 66 20 74 68 65 20 57 69 6e 64 6f 77 20 77 68 6f 73 65 20 6b 65 79 73 20 79 6f 75 20 6e 6f 20 6c 6f 6e 67 65 72 20 77 68 69 73 68 20 74 6f 20 6c 6f 67 3c 2f 64 65 66 69 6e}
		$s16 = {3c 63 6f 6d 6d 61 6e 64 20 69 64 3d 22 33 32 22 3e}
		$s17 = {3c 63 6f 6d 6d 61 6e 64 20 69 64 3d 22 33 22 3e}
		$s18 = {3c 63 6f 6d 6d 61 6e 64 20 69 64 3d 22 37 22 3e}
		$s19 = {3c 63 6f 6d 6d 61 6e 64 20 69 64 3d 22 31 22 3e}
		$s20 = {3c 63 6f 6d 6d 61 6e 64 20 69 64 3d 22 34 22 3e}

	condition:
		10 of them
}

rule FiveEyes_QUERTY_Malwareqwerty_20120 : hardened
{
	meta:
		description = "FiveEyes QUERTY Malware - file 20120.xml"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		author = "Florian Roth (Nextron Systems)"
		reference = "http://www.spiegel.de/media/media-35668.pdf"
		date = "2015/01/18"
		hash = "597082f05bfd3225587d480c30f54a7a1326a892"
		id = "503c71de-1bc5-5690-944c-a60917a4da09"

	strings:
		$s0 = {3c 63 6f 6e 66 69 67 46 69 6c 65 4e 61 6d 65 3e 32 30 31 32 30 5f 63 6d 64 44 65 66 2e 78 6d 6c 3c 2f 63 6f 6e 66 69 67 46 69 6c 65 4e 61 6d 65 3e}
		$s1 = {3c 6e 61 6d 65 3e 32 30 31 32 30 2e 64 6c 6c 3c 2f 6e 61 6d 65 3e}
		$s2 = {3c 63 6f 64 65 62 61 73 65 3e 22 52 65 73 65 72 76 65 64 20 66 6f 72 20 66 75 74 75 72 65 20 75 73 65 2e 22 3c 2f 63 6f 64 65 62 61 73 65 3e}
		$s3 = {3c 70 6c 75 67 69 6e 20 78 6d 6c 6e 73 3a 78 73 69 3d 22 68 74 74 70 3a 2f 2f 77 77 77 2e 77 33 2e 6f 72 67 2f 32 30 30 31 2f 58 4d 4c 53 63 68 65 6d 61 2d 69 6e 73 74 61 6e 63 65 22 20 78 73 69 3a 6e 6f 4e 61 6d 65 73 70 61 63 65 53}
		$s4 = {3c 70 6c 61 74 66 6f 72 6d 20 74 79 70 65 3d 22 31 22 3e}
		$s5 = {3c 2f 70 6c 75 67 69 6e 3e}
		$s6 = {3c 2f 70 6c 75 67 69 6e 43 6f 6e 66 69 67 3e}
		$s7 = {3c 70 6c 75 67 69 6e 43 6f 6e 66 69 67 3e}
		$s8 = {3c 2f 70 6c 61 74 66 6f 72 6d 3e}
		$s9 = {3c 2f 6c 70 43 6f 6e 66 69 67 3e}
		$s10 = {3c 6c 70 43 6f 6e 66 69 67 3e}

	condition:
		all of them
}

rule FiveEyes_QUERTY_Malwaresig_20121_cmdDef : hardened
{
	meta:
		description = "FiveEyes QUERTY Malware - file 20121_cmdDef.xml"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		author = "Florian Roth (Nextron Systems)"
		reference = "http://www.spiegel.de/media/media-35668.pdf"
		date = "2015/01/18"
		hash = "64ac06aa4e8d93ea6063eade7ce9687b1d035907"
		id = "2deb73f7-372e-5d29-a077-431ab1967d93"

	strings:
		$s0 = {3c 73 68 6f 72 74 44 65 73 63 72 69 70 74 69 6f 6e 3e 4b 65 79 73 74 72 6f 6b 65 20 4c 6f 67 67 65 72 20 50 6c 75 67 69 6e 2e 3c 2f 73 68 6f 72 74 44 65 73 63 72 69 70 74 69 6f 6e 3e}
		$s1 = {3c 6d 65 73 73 61 67 65 3e 46 61 69 6c 65 64 20 74 6f 20 67 65 74 20 46 69 6c 65 20 54 69 6d 65 3c 2f 6d 65 73 73 61 67 65 3e}
		$s2 = {3c 64 65 73 63 72 69 70 74 69 6f 6e 3e 4b 65 79 73 74 72 6f 6b 65 20 4c 6f 67 67 65 72 20 50 6c 75 67 69 6e 2e 3c 2f 64 65 73 63 72 69 70 74 69 6f 6e 3e}
		$s3 = {3c 6d 65 73 73 61 67 65 3e 46 61 69 6c 65 64 20 74 6f 20 73 65 74 20 46 69 6c 65 20 54 69 6d 65 3c 2f 6d 65 73 73 61 67 65 3e}
		$s4 = {3c 2f 63 6f 6d 6d 61 6e 64 73 3e}
		$s5 = {3c 63 6f 6d 6d 61 6e 64 73 3e}
		$s6 = {3c 2f 76 65 72 73 69 6f 6e 3e}
		$s7 = {3c 61 73 73 6f 63 69 61 74 65 64 49 6d 70 6c 61 6e 74 49 64 3e 32 30 31 32 30 3c 2f 61 73 73 6f 63 69 61 74 65 64 49 6d 70 6c 61 6e 74 49 64 3e}
		$s8 = {3c 6d 65 73 73 61 67 65 3e 4e 6f 20 43 6f 6d 6d 73 2e 20 77 69 74 68 20 44 72 69 76 65 72 3c 2f 6d 65 73 73 61 67 65 3e}
		$s9 = {3c 2f 65 72 72 6f 72 3e}
		$s10 = {3c 6d 65 73 73 61 67 65 3e 49 6e 76 61 6c 69 64 20 46 69 6c 65 20 53 69 7a 65 3c 2f 6d 65 73 73 61 67 65 3e}
		$s11 = {3c 70 6c 61 74 66 6f 72 6d 73 3e 57 69 6e 64 6f 77 73 20 28 55 73 65 72 2f 57 69 6e 33 32 29 3c 2f 70 6c 61 74 66 6f 72 6d 73 3e}
		$s12 = {3c 6d 65 73 73 61 67 65 3e 46 69 6c 65 20 53 69 7a 65 20 4d 69 73 6d 61 74 63 68 3c 2f 6d 65 73 73 61 67 65 3e}
		$s13 = {3c 70 72 6f 6a 65 63 74 70 61 74 68 3e 70 6c 75 67 69 6e 2f 55 74 69 6c 69 74 79 3c 2f 70 72 6f 6a 65 63 74 70 61 74 68 3e}
		$s14 = {3c 70 6c 75 67 69 6e 73 44 65 70 65 6e 64 3e 4e 6f 6e 65 3c 2f 70 6c 75 67 69 6e 73 44 65 70 65 6e 64 3e}
		$s15 = {3c 64 6c 6c 44 65 70 65 6e 64 3e 4e 6f 6e 65 3c 2f 64 6c 6c 44 65 70 65 6e 64 3e}
		$s16 = {3c 70 6c 75 67 69 6e 6e 61 6d 65 3e 45 5f 51 77 65 72 74 79 49 4d 3c 2f 70 6c 75 67 69 6e 6e 61 6d 65 3e}
		$s17 = {3c 72 69 67 68 74 73 52 65 71 75 69 72 65 64 3e 4e 6f 6e 65 3c 2f 72 69 67 68 74 73 52 65 71 75 69 72 65 64 3e}
		$s18 = {3c 6d 69 6e 6f 72 54 79 70 65 3e 30 3c 2f 6d 69 6e 6f 72 54 79 70 65 3e}
		$s19 = {3c 63 6f 64 65 3e 30 30 30 30 31 30 30 32 3c 2f 63 6f 64 65 3e}
		$s20 = {3c 63 6f 64 65 3e 30 30 30 30 31 30 30 31 3c 2f 63 6f 64 65 3e}

	condition:
		12 of them
}

