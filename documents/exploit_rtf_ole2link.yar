rule malrtf_ole2link : exploit hardened limited
{
	meta:
		author = "@h3x2b <tracker _AT h3x.eu>"
		description = "Detects weaponized RTF documents with OLE2Link exploit"
		id = "5080e79a-3abc-5fc3-902e-b362f20510f9"
		score = 60

	strings:
		$rtf_olelink_01 = {5c 6f 62 6a 64 61 74 61}
		$rtf_olelink_02 = {34 66 34 63 34 35 33 32 34 63 36 39 36 65 36 62}
		$rtf_olelink_03 = {64 30 63 66 31 31 65 30 61 31 62 31 31 61 65 31}
		$rtf_payload_01 = {36 38 30 30 37 34 30 30 37 34 30 30 37 30 30 30 33 61 30 30 32 66 30 30 32 66 30 30}
		$rtf_payload_02 = {36 38 30 30 37 34 30 30 37 34 30 30 37 30 30 30 37 33 30 30 33 61 30 30 32 66 30 30 32 66 30 30}
		$rtf_payload_03 = {36 36 30 30 37 34 30 30 37 30 30 30 33 61 30 30 32 66 30 30 32 66 30 30}

	condition:
		uint32be( 0 ) == 0x7B5C7274 and all of ( $rtf_olelink_* ) and any of ( $rtf_payload_* )
}

