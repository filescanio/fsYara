rule AAR : hardened
{
	meta:
		author = " Kevin Breen <kevin@techanarchy.net>"
		date = "2014/04"
		ref = "http://malwareconfig.com/stats/AAR"
		maltype = "Remote Access Trojan"
		filetype = "exe"

	strings:
		$a = {48 61 73 68 74 61 62 6c 65}
		$b = {67 65 74 5f 49 73 44 69 73 70 6f 73 65 64}
		$c = {54 72 69 70 6c 65 44 45 53}
		$d = {74 65 73 74 6d 65 6d 6f 72 79 2e 46 52 4d 4d 61 69 6e 2e 72 65 73 6f 75 72 63 65 73}
		$e = {24 00 74 00 68 00 69 00 73 00 2e 00 49 00 63 00 6f 00 6e 00}
		$f = {7b 00 31 00 31 00 31 00 31 00 31 00 2d 00 32 00 32 00 32 00 32 00 32 00 2d 00 32 00 30 00 30 00 30 00 31 00 2d 00 30 00 30 00 30 00 30 00 31 00 7d 00}
		$g = {40 40 40 40 40}

	condition:
		all of them
}

rule RAT_Adzok : hardened
{
	meta:
		author = "Kevin Breen <kevin@techanarchy.net>"
		description = "Detects Adzok RAT"
		Versions = "Free 1.0.0.3,"
		date = "01.05.2015"
		reference = "http://malwareconfig.com/stats/Adzok"
		maltype = "Remote Access Trojan"
		filetype = "jar"
		id = "93807f85-ae4e-5fd2-9010-ed2cf6f57f38"

	strings:
		$a1 = {63 6f 6e 66 69 67 2e 78 6d 6c 50 4b}
		$a2 = {6b 65 79 2e 63 6c 61 73 73 50 4b}
		$a3 = {73 76 64 24 31 2e 63 6c 61 73 73 50 4b}
		$a4 = {73 76 64 24 32 2e 63 6c 61 73 73 50 4b}
		$a5 = {4d 65 6e 73 61 6a 65 2e 63 6c 61 73 73 50 4b}
		$a6 = {69 6e 69 63 24 53 68 75 74 64 6f 77 6e 48 6f 6f 6b 2e 63 6c 61 73 73}
		$a7 = {55 6e 69 6e 73 74 61 6c 6c 2e 6a 61 72 50 4b}
		$a8 = {72 65 73 6f 75 72 63 65 73 2f 69 63 6f 6e 6f 2e 70 6e 67 50 4b}

	condition:
		7 of ( $a* )
}

rule RAT_Ap0calypse : hardened
{
	meta:
		author = "Kevin Breen <kevin@techanarchy.net>"
		description = "Detects Ap0calypse RAT"
		date = "01.04.2014"
		reference = "http://malwareconfig.com/stats/Ap0calypse"
		maltype = "Remote Access Trojan"
		filetype = "exe"
		id = "a2993654-efa0-519b-b6f6-4d722d93adde"

	strings:
		$a = {41 70 30 63 61 6c 79 70 73 65}
		$b = {53 69 66 72 65}
		$c = {4d 73 67 47 6f 73 74 65 72}
		$d = {42 61 73 6c 69 6b}
		$e = {44 6f 73 79 61 6c 61 72 73}
		$f = {49 6e 6a 65 63 73 69 79 6f 6e}

	condition:
		all of them
}

rule RAT_Arcom : hardened
{
	meta:
		author = "Kevin Breen <kevin@techanarchy.net>"
		date = "01.04.2014"
		description = "Detects Arcom RAT"
		reference = "http://malwareconfig.com/stats/Arcom"
		maltype = "Remote Access Trojan"
		filetype = "exe"
		id = "a0598340-c4a5-53f0-a810-63e37ec669a5"

	strings:
		$a1 = {43 56 75 33 33 38 38 66 6e 65 6b 33 57 28 33 69 6a 33 66 6b 70 30 39 33 30 64 69}
		$a2 = {5a 49 4e 47 41 57 49 32}
		$a3 = {63 6c 57 65 62 4c 69 67 68 74 47 6f 6c 64 65 6e 72 6f 64 59 65 6c 6c 6f 77}
		$a4 = {41 00 6e 00 63 00 65 00 73 00 74 00 6f 00 72 00 20 00 66 00 6f 00 72 00 20 00 27 00 25 00 73 00 27 00 20 00 6e 00 6f 00 74 00 20 00 66 00 6f 00 75 00 6e 00 64 00}
		$a5 = {43 00 6f 00 6e 00 74 00 72 00 6f 00 6c 00 2d 00 43 00 20 00 68 00 69 00 74 00}
		$a6 = {A3 24 25 21}

	condition:
		all of them
}

rule RAT_Bandook : hardened
{
	meta:
		author = "Kevin Breen <kevin@techanarchy.net>"
		date = "01.04.2014"
		description = "Detects Bandook RAT"
		reference = "http://malwareconfig.com/stats/bandook"
		maltype = "Remote Access Trojan"
		filetype = "exe"
		id = "79fb99d8-bd56-5986-9917-e119b51b8303"

	strings:
		$a = {61 61 61 61 61 61 31 7c}
		$b = {61 61 61 61 61 61 32 7c}
		$c = {61 61 61 61 61 61 33 7c}
		$d = {61 61 61 61 61 61 34 7c}
		$e = {61 61 61 61 61 61 35 7c}
		$f = {25 73 25 64 2e 65 78 65}
		$g = {61 73 74 61 6c 61 76 69 73 74 61}
		$h = {67 69 76 65 6d 65 63 61 63 68 65}
		$i = {25 73 5c 73 79 73 74 65 6d 33 32 5c 64 72 69 76 65 72 73 5c 62 6c 6f 67 73 5c 2a}
		$j = {62 6e 64 6b 31 33 6d 65}

	condition:
		all of them
}

rule RAT_BlackNix : hardened
{
	meta:
		author = "Kevin Breen <kevin@techanarchy.net>"
		date = "01.04.2014"
		description = "Detects BlackNix RAT"
		reference = "http://malwareconfig.com/stats/BlackNix"
		maltype = "Remote Access Trojan"
		filetype = "exe"
		id = "d7814184-3ae4-53f1-a602-c3fbc02573c3"

	strings:
		$a1 = {53 00 45 00 54 00 54 00 49 00 4e 00 47 00 53 00}
		$a2 = {4d 61 72 6b 20 41 64 6c 65 72}
		$a3 = {52 61 6e 64 6f 6d 2d 4e 75 6d 62 65 72 2d 48 65 72 65}
		$a4 = {52 65 6d 6f 74 65 53 68 65 6c 6c}
		$a5 = {53 79 73 74 65 6d 49 6e 66 6f}

	condition:
		all of them
}

rule RAT_BlackShades : hardened
{
	meta:
		author = "Brian Wallace (@botnet_hunter)"
		date = "01.04.2014"
		description = "Detects BlackShades RAT"
		reference = "http://blog.cylance.com/a-study-in-bots-blackshades-net"
		family = "blackshades"
		id = "039f9efd-034d-5088-9a2f-7a63ad170d3d"

	strings:
		$string1 = {62 73 73 5f 73 65 72 76 65 72}
		$string2 = {74 78 74 43 68 61 74}
		$string3 = {55 44 50 46 6c 6f 6f 64}

	condition:
		uint16( 0 ) == 0x5a4d and all of them
}

rule RAT_ClientMesh : hardened
{
	meta:
		author = "Kevin Breen <kevin@techanarchy.net> (slightly modified by Florian Roth to improve performance)"
		date = "01.06.2014"
		description = "Detects ClientMesh RAT"
		reference = "http://malwareconfig.com/stats/ClientMesh"
		family = "torct"
		id = "351df33e-d3a1-5fe8-be38-edb43bc5d38f"

	strings:
		$string1 = {6d 61 63 68 69 6e 65 64 65 74 61 69 6c 73}
		$string2 = {4d 79 53 65 74 74 69 6e 67 73}
		$string3 = {73 65 6e 64 66 74 70 70 61 73 73 77 6f 72 64 73}
		$string4 = {73 65 6e 64 62 72 6f 77 73 65 72 70 61 73 73 77 6f 72 64 73}
		$string5 = {61 72 6d 61 32 6b 65 79 4d 61 73 73}
		$string6 = {6b 65 79 6c 6f 67 67 65 72}

	condition:
		all of them
}

rule RAT_CyberGate : refined hardened
{
	meta:
		author = "Kevin Breen <kevin@techanarchy.net>"
		date = "01.04.2014"
		score = 60
		description = "Detects CyberGate RAT"
		reference = "http://malwareconfig.com/stats/CyberGate"
		maltype = "Remote Access Trojan"
		filetype = "exe"
		id = "387e7c89-c766-54cf-aac0-3ba03092bc25"

	strings:
		$string1 = {23 23 23 23 40 23 23 23 23 E8 EE E9 F9 23 23 23 23 40 23 23 23 23}
		$string2 = {23 23 23 23 40 23 23 23 23 FA FD F0 EF F9 23 23 23 23 40 23 23 23 23}
		$string3 = {45 64 69 74 53 76 72}
		$string4 = {54 4c 6f 61 64 65 72}
		$string5 = {53 74 72 6f 6b 73}
		$string6 = {23 23 23 23 40 23 23 23 23}
		$merge1 = {41 76 65 6e 67 65 72 20 62 79 20 4e 68 54}
		$merge2 = {47 52 45 41 4d 45}
		$res1 = {58 58 2d 58 58 2d 58 58 2d 58 58}
		$res2 = {43 47 2d 43 47 2d 43 47 2d 43 47}

	condition:
		all of ( $string* ) and ( any of ( $res* ) or all of ( $merge* ) )
}

rule RAT_DarkRAT : hardened
{
	meta:
		author = "Kevin Breen <kevin@techanarchy.net>"
		date = "01.04.2014"
		score = 70
		description = "Detects DarkRAT"
		reference = "http://malwareconfig.com/stats/DarkRAT"
		maltype = "Remote Access Trojan"
		filetype = "exe"
		id = "8283236a-6ed1-5213-8386-a029867b9677"

	strings:
		$a = {40 31 39 30 36 64 61 72 6b 31 39 39 36 63 6f 64 65 72 40}
		$b = {53 48 45 6d 70 74 79 52 65 63 79 63 6c 65 42 69 6e 41}
		$c = {6d 63 69 53 65 6e 64 53 74 72 69 6e 67 41}
		$d = {61 64 64 5f 53 68 75 74 64 6f 77 6e}
		$e = {67 65 74 5f 53 61 76 65 4d 79 53 65 74 74 69 6e 67 73 4f 6e 45 78 69 74}
		$f = {67 65 74 5f 53 70 65 63 69 61 6c 44 69 72 65 63 74 6f 72 69 65 73}
		$g = {43 6c 69 65 6e 74 2e 4d 79}

	condition:
		all of them
}

rule RAT_HawkEye : hardened
{
	meta:
		author = "Kevin Breen <kevin@techanarchy.net>"
		date = "01.06.2015"
		description = "Detects HawkEye RAT"
		reference = "http://malwareconfig.com/stats/HawkEye"
		maltype = "KeyLogger"
		filetype = "exe"
		score = 70
		id = "22b1d1e6-feea-5f84-9564-326ad80bbd8d"

	strings:
		$key = {48 00 61 00 77 00 6b 00 45 00 79 00 65 00 4b 00 65 00 79 00 6c 00 6f 00 67 00 67 00 65 00 72 00}
		$salt = {30 00 39 00 39 00 75 00 37 00 38 00 37 00 39 00 37 00 38 00 37 00 38 00 36 00}
		$string1 = {48 00 61 00 77 00 6b 00 45 00 79 00 65 00 5f 00 4b 00 65 00 79 00 6c 00 6f 00 67 00 67 00 65 00 72 00}
		$string2 = {68 00 6f 00 6c 00 64 00 65 00 72 00 6d 00 61 00 69 00 6c 00 2e 00 74 00 78 00 74 00}
		$string3 = {77 00 61 00 6c 00 6c 00 65 00 74 00 2e 00 64 00 61 00 74 00}
		$string4 = {4b 00 65 00 79 00 6c 00 6f 00 67 00 20 00 52 00 65 00 63 00 6f 00 72 00 64 00 73 00}
		$string5 = {3c 00 21 00 2d 00 2d 00 20 00 64 00 6f 00 20 00 6e 00 6f 00 74 00 20 00 73 00 63 00 72 00 69 00 70 00 74 00 20 00 2d 00 2d 00 3e 00}
		$string6 = {5c 00 70 00 69 00 64 00 6c 00 6f 00 63 00 2e 00 74 00 78 00 74 00}
		$string7 = {42 00 53 00 50 00 4c 00 49 00 54 00}

	condition:
		$key and $salt and all of ( $string* )
}

rule RAT_Imminent : hardened
{
	meta:
		author = "Kevin Breen <kevin@techanarchy.net>"
		date = "01.04.2014"
		description = "Detects Imminent RAT"
		reference = "http://malwareconfig.com/stats/Imminent"
		maltype = "Remote Access Trojan"
		filetype = "exe"
		id = "deddef60-c309-54e0-a488-ce937ed7eae3"

	strings:
		$v1a = {44 65 63 6f 64 65 50 72 6f 64 75 63 74 4b 65 79}
		$v1b = {53 74 61 72 74 48 54 54 50 46 6c 6f 6f 64}
		$v1c = {43 6f 64 65 4b 65 79}
		$v1d = {4d 45 53 53 41 47 45 42 4f 58}
		$v1e = {47 65 74 46 69 6c 65 7a 69 6c 6c 61 50 61 73 73 77 6f 72 64 73}
		$v1f = {44 61 74 61 49 6e}
		$v1g = {55 44 50 7a 53 6f 63 6b 65 74 73}
		$v1h = {52 00 54 00 5F 00 52 00 43 00 44 00 41 00 54 00 41}
		$v2a = {3c 55 52 4c 3e 6b 5f 5f 42 61 63 6b 69 6e 67 46 69 65 6c 64}
		$v2b = {3c 52 75 6e 48 69 64 64 65 6e 3e 6b 5f 5f 42 61 63 6b 69 6e 67 46 69 65 6c 64}
		$v2c = {44 6f 77 6e 6c 6f 61 64 41 6e 64 45 78 65 63 75 74 65}
		$v2d = {2d 00 43 00 48 00 45 00 43 00 4b 00 20 00 26 00 20 00 50 00 49 00 4e 00 47 00 20 00 2d 00 6e 00 20 00 32 00 20 00 31 00 32 00 37 00 2e 00 30 00 2e 00 30 00 2e 00 31 00 20 00 26 00 20 00 45 00 58 00 49 00 54 00}
		$v2e = {65 00 6e 00 67 00 6c 00 61 00 6e 00 64 00 2e 00 70 00 6e 00 67 00}
		$v2f = {53 00 68 00 6f 00 77 00 65 00 64 00 20 00 4d 00 65 00 73 00 73 00 61 00 67 00 65 00 62 00 6f 00 78 00}

	condition:
		all of ( $v1* ) or all of ( $v2* )
}

rule RAT_Infinity : hardened
{
	meta:
		author = "Kevin Breen <kevin@techanarchy.net>"
		date = "01.04.2014"
		description = "Detects Infinity RAT"
		reference = "http://malwareconfig.com/stats/Infinity"
		maltype = "Remote Access Trojan"
		filetype = "exe"
		id = "b70f9459-fa84-516f-841d-d9617856eb4d"

	strings:
		$a = {43 52 59 50 54 50 52 4f 54 45 43 54 5f 50 52 4f 4d 50 54 53 54 52 55 43 54}
		$b = {64 69 73 63 6f 6d 6f 75 73 65}
		$c = {47 65 74 44 65 65 70 49 6e 66 6f}
		$d = {41 45 53 5f 45 6e 63 72 79 70 74}
		$e = {53 74 61 72 74 55 44 50 46 6c 6f 6f 64}
		$f = {42 00 41 00 54 00 53 00 63 00 72 00 69 00 70 00 74 00 69 00 6e 00 67 00}
		$g = {46 00 42 00 71 00 49 00 4e 00 68 00 52 00 64 00 70 00 67 00 6e 00 71 00 41 00 54 00 78 00 4a 00 2e 00 68 00 74 00 6d 00 6c 00}
		$i = {6d 00 61 00 67 00 69 00 63 00 5f 00 6b 00 65 00 79 00}

	condition:
		all of them
}

rule RAT_LostDoor : hardened
{
	meta:
		author = "Kevin Breen <kevin@techanarchy.net>"
		date = "01.04.2014"
		description = "Detects LostDoor RAT"
		reference = "http://malwareconfig.com/stats/LostDoor"
		maltype = "Remote Access Trojan"
		filetype = "exe"
		id = "f86ae7a1-2182-5b2e-8f9e-9e8456f574bc"

	strings:
		$a0 = {0D 0A 2A 45 44 49 54 5F 53 45 52 56 45 52 2A 0D 0A}
		$a1 = {2a 6d 6c 74 2a 20 3d 20 25}
		$a2 = {2a 69 70 2a 20 3d 20 25}
		$a3 = {2a 76 69 63 74 69 6d 6f 2a 20 3d 20 25}
		$a4 = {2a 6e 61 6d 65 2a 20 3d 20 25}
		$b5 = {5b 53 54 41 52 54 5d}
		$b6 = {5b 44 41 54 41 5d}
		$b7 = {((57 65 20 43 6f 6e 74 72 6f 6c 20 59 6f 75 72 20 44 69 67 69 74 61 6c 20 57 6f 72 6c 64) | (57 00 65 00 20 00 43 00 6f 00 6e 00 74 00 72 00 6f 00 6c 00 20 00 59 00 6f 00 75 00 72 00 20 00 44 00 69 00 67 00 69 00 74 00 61 00 6c 00 20 00 57 00 6f 00 72 00 6c 00 64 00))}
		$b8 = {((52 43 34 49 6e 69 74 69 61 6c 69 7a 65) | (52 00 43 00 34 00 49 00 6e 00 69 00 74 00 69 00 61 00 6c 00 69 00 7a 00 65 00))}
		$b9 = {((52 43 34 44 65 63 72 79 70 74) | (52 00 43 00 34 00 44 00 65 00 63 00 72 00 79 00 70 00 74 00))}

	condition:
		all of ( $a* ) or all of ( $b* )
}

rule RAT_LuminosityLink : hardened
{
	meta:
		author = "Kevin Breen <kevin@techanarchy.net>"
		date = "01.04.2014"
		description = "Detects LuminosityLink RAT"
		reference = "http://malwareconfig.com/stats/LuminosityLink"
		maltype = "Remote Access Trojan"
		filetype = "exe"
		id = "163fe10c-38a1-53d3-b3a5-4240229e0306"

	strings:
		$a = {53 00 4d 00 41 00 52 00 54 00 4c 00 4f 00 47 00 53 00}
		$b = {52 00 55 00 4e 00 50 00 45 00}
		$c = {62 00 2e 00 52 00 65 00 73 00 6f 00 75 00 72 00 63 00 65 00 73 00}
		$d = {43 00 4c 00 49 00 45 00 4e 00 54 00 49 00 4e 00 46 00 4f 00 2a 00}
		$e = {49 00 6e 00 76 00 61 00 6c 00 69 00 64 00 20 00 57 00 65 00 62 00 63 00 61 00 6d 00 20 00 44 00 72 00 69 00 76 00 65 00 72 00 20 00 44 00 6f 00 77 00 6e 00 6c 00 6f 00 61 00 64 00 20 00 55 00 52 00 4c 00 2c 00 20 00 6f 00 72 00 20 00 46 00 61 00 69 00 6c 00 65 00 64 00 20 00 74 00 6f 00 20 00 44 00 6f 00 77 00 6e 00 6c 00 6f 00 61 00 64 00 20 00 46 00 69 00 6c 00 65 00 21 00}
		$f = {50 00 72 00 6f 00 61 00 63 00 74 00 69 00 76 00 65 00 20 00 41 00 6e 00 74 00 69 00 2d 00 4d 00 61 00 6c 00 77 00 61 00 72 00 65 00 20 00 68 00 61 00 73 00 20 00 62 00 65 00 65 00 6e 00 20 00 6d 00 61 00 6e 00 75 00 61 00 6c 00 6c 00 79 00 20 00 61 00 63 00 74 00 69 00 76 00 61 00 74 00 65 00 64 00 21 00}
		$g = {52 00 45 00 4d 00 4f 00 56 00 45 00 47 00 55 00 41 00 52 00 44 00}
		$h = {43 00 30 00 6e 00 31 00 66 00 38 00}
		$i = {4c 00 75 00 6d 00 69 00 6e 00 6f 00 73 00 69 00 74 00 79 00}
		$j = {4c 00 75 00 6d 00 69 00 6e 00 6f 00 73 00 69 00 74 00 79 00 43 00 72 00 79 00 70 00 74 00 6f 00 4d 00 69 00 6e 00 65 00 72 00}
		$k = {4d 00 41 00 4e 00 41 00 47 00 45 00 52 00 2a 00 43 00 4c 00 49 00 45 00 4e 00 54 00 44 00 45 00 54 00 41 00 49 00 4c 00 53 00 2a 00}

	condition:
		all of them
}

rule RAT_LuxNet : hardened
{
	meta:
		author = "Kevin Breen <kevin@techanarchy.net>"
		date = "01.04.2014"
		description = "Detects LuxNet RAT"
		reference = "http://malwareconfig.com/stats/LuxNet"
		maltype = "Remote Access Trojan"
		filetype = "exe"
		id = "277db509-5ba0-5d1b-b17a-d5914f1f1650"

	strings:
		$a = {47 65 74 48 61 73 68 43 6f 64 65}
		$b = {41 63 74 69 76 61 74 6f 72}
		$c = {57 65 62 43 6c 69 65 6e 74}
		$d = {6f 70 5f 45 71 75 61 6c 69 74 79}
		$e = {64 00 69 00 63 00 6b 00 63 00 75 00 72 00 73 00 6f 00 72 00 2e 00 63 00 75 00 72 00}
		$f = {7b 00 30 00 7d 00 7c 00 7b 00 31 00 7d 00 7c 00 7b 00 32 00 7d 00}

	condition:
		all of them
}

rule RAT_NanoCore : refined hardened
{
	meta:
		author = "Kevin Breen <kevin@techanarchy.net>"
		date = "01.04.2014"
		description = "Detects NanoCore RAT"
		reference = "http://malwareconfig.com/stats/NanoCore"
		maltype = "Remote Access Trojan"
		filetype = "exe"
		vetted_family = "NanoCore"

	strings:
		$a = {4e 61 6e 6f 43 6f 72 65}
		$b = {43 6c 69 65 6e 74 50 6c 75 67 69 6e}
		$c = {50 72 6f 6a 65 63 74 44 61 74 61}
		$d = {44 45 53 43 72 79 70 74 6f}
		$e = {4b 65 65 70 41 6c 69 76 65}
		$f = {49 50 4e 45 54 52 4f 57}
		$g = {4c 6f 67 43 6c 69 65 6e 74 4d 65 73 73 61 67 65}
		$h = {7c 43 6c 69 65 6e 74 48 6f 73 74}
		$i = {67 65 74 5f 43 6f 6e 6e 65 63 74 65 64}
		$j = {23 3d 71}
		$key = {43 6f 24 cb 95 30 38 39}

	condition:
		9 of them
}

rule RAT_NetWire : hardened
{
	meta:
		author = "Kevin Breen <kevin@techanarchy.net> & David Cannings"
		date = "01.04.2014"
		description = "Detects NetWire RAT"
		reference = "http://malwareconfig.com/stats/NetWire"
		maltype = "Remote Access Trojan"
		filetype = "exe"
		id = "f0077e8c-3e6a-5a98-9171-b0d81f24d27a"

	strings:
		$exe1 = {25 2e 32 64 2d 25 2e 32 64 2d 25 2e 34 64}
		$exe2 = {25 73 25 2e 32 64 2d 25 2e 32 64 2d 25 2e 34 64}
		$exe3 = {5b 25 73 5d 20 2d 20 5b 25 2e 32 64 2f 25 2e 32 64 2f 25 64 20 25 2e 32 64 3a 25 2e 32 64 3a 25 2e 32 64 5d}
		$exe4 = {77 63 6e 77 43 6c 61 73 73}
		$exe5 = {5b 43 74 72 6c 2b 25 63 5d}
		$exe6 = {53 59 53 54 45 4d 5c 43 75 72 72 65 6e 74 43 6f 6e 74 72 6f 6c 53 65 74 5c 43 6f 6e 74 72 6f 6c 5c 50 72 6f 64 75 63 74 4f 70 74 69 6f 6e 73}
		$exe7 = {25 73 5c 2e 70 75 72 70 6c 65 5c 61 63 63 6f 75 6e 74 73 2e 78 6d 6c}

	condition:
		all of them
}

rule RAT_Pandora : hardened
{
	meta:
		author = "Kevin Breen <kevin@techanarchy.net>"
		date = "01.04.2014"
		description = "Detects Pandora RAT"
		reference = "http://malwareconfig.com/stats/Pandora"
		maltype = "Remote Access Trojan"
		filetype = "exe"
		id = "d31e4366-8911-5c9c-92dc-a99f5233c626"

	strings:
		$a = {43 61 6e 27 74 20 67 65 74 20 74 68 65 20 57 69 6e 64 6f 77 73 20 76 65 72 73 69 6f 6e}
		$b = {3d 4d 3d 51 3d 55 3d 59 3d 5d 3d 61 3d 65 3d 69 3d 6d 3d 71 3d 75 3d 79 3d 7d 3d}
		$c = {4a 00 50 00 45 00 47 00 20 00 65 00 72 00 72 00 6f 00 72 00 20 00 23 00 25 00 64 00}
		$d = {43 00 61 00 6e 00 6e 00 6f 00 74 00 20 00 61 00 73 00 73 00 69 00 67 00 6e 00 20 00 61 00 20 00 25 00 73 00 20 00 74 00 6f 00 20 00 61 00 20 00 25 00 73 00}
		$g = {25 73 2c 20 50 72 6f 67 49 44 3a}
		$h = {63 6c 61 76 65}
		$i = {53 68 65 6c 6c 5f 54 72 61 79 57 6e 64}
		$j = {6d 65 6c 74 2e 62 61 74}
		$k = {5c 53 74 75 62 50 61 74 68}
		$l = {5c 6c 6f 67 73 2e 64 61 74}
		$m = {31 30 32 37 7c 4f 70 65 72 61 74 69 6f 6e 20 68 61 73 20 62 65 65 6e 20 63 61 6e 63 65 6c 65 64 21}
		$n = {34 36 36 7c 59 6f 75 20 6e 65 65 64 20 74 6f 20 70 6c 75 67 2d 69 6e 21 20 44 6f 75 62 6c 65 20 63 6c 69 63 6b 20 74 6f 20 69 6e 73 74 61 6c 6c 2e 2e 2e 20 7c}
		$0 = {33 33 7c 5b 4b 65 79 6c 6f 67 67 65 72 20 4e 6f 74 20 41 63 74 69 76 61 74 65 64 21 5d}

	condition:
		all of them
}

rule RAT_Paradox : hardened
{
	meta:
		author = "Kevin Breen <kevin@techanarchy.net>"
		date = "01.04.2014"
		description = "Detects Paradox RAT"
		reference = "http://malwareconfig.com/stats/Paradox"
		maltype = "Remote Access Trojan"
		filetype = "exe"
		score = 50
		id = "2f1e6226-799b-54eb-a4a4-6c0f1bf561b4"

	strings:
		$a = {50 61 72 61 64 6f 78 52 41 54}
		$b = {46 6f 72 6d 31}
		$c = {53 74 61 72 74 52 4d 43 61 6d}
		$d = {46 6c 6f 6f 64 65 72 73}
		$e = {53 6c 6f 77 4c 61 72 69 73}
		$f = {53 48 49 54 45 4d 49 44}
		$g = {73 65 74 5f 52 65 6d 6f 74 65 5f 43 68 61 74}

	condition:
		all of them
}

rule RAT_Plasma : hardened
{
	meta:
		author = "Kevin Breen <kevin@techanarchy.net>"
		date = "01.04.2014"
		description = "Detects Plasma RAT"
		reference = "http://malwareconfig.com/stats/Plasma"
		maltype = "Remote Access Trojan"
		filetype = "exe"
		id = "2a19c0de-0078-5487-869c-1bcabea57300"

	strings:
		$a = {4d 00 69 00 6e 00 65 00 72 00 3a 00 20 00 46 00 61 00 69 00 6c 00 65 00 64 00 20 00 74 00 6f 00 20 00 49 00 6e 00 6a 00 65 00 63 00 74 00 2e 00}
		$b = {53 00 74 00 61 00 72 00 74 00 65 00 64 00 20 00 47 00 50 00 55 00 20 00 4d 00 69 00 6e 00 69 00 6e 00 67 00 20 00 6f 00 6e 00 3a 00}
		$c = {42 00 4b 00 3a 00 20 00 48 00 61 00 72 00 64 00 20 00 42 00 6f 00 74 00 20 00 4b 00 69 00 6c 00 6c 00 65 00 72 00 20 00 52 00 61 00 6e 00 20 00 53 00 75 00 63 00 63 00 65 00 73 00 73 00 66 00 75 00 6c 00 6c 00 79 00 21 00}
		$d = {55 00 70 00 6c 00 6f 00 61 00 64 00 65 00 64 00 20 00 4b 00 65 00 79 00 6c 00 6f 00 67 00 73 00 20 00 53 00 75 00 63 00 63 00 65 00 73 00 73 00 66 00 75 00 6c 00 6c 00 79 00 21 00}
		$e = {4e 00 6f 00 20 00 53 00 6c 00 6f 00 77 00 6c 00 6f 00 72 00 69 00 73 00 20 00 41 00 74 00 74 00 61 00 63 00 6b 00 20 00 69 00 73 00 20 00 52 00 75 00 6e 00 6e 00 69 00 6e 00 67 00 21 00}
		$f = {41 00 6e 00 20 00 41 00 52 00 4d 00 45 00 20 00 41 00 74 00 74 00 61 00 63 00 6b 00 20 00 69 00 73 00 20 00 41 00 6c 00 72 00 65 00 61 00 64 00 79 00 20 00 52 00 75 00 6e 00 6e 00 69 00 6e 00 67 00 20 00 6f 00 6e 00}
		$g = {50 00 72 00 6f 00 61 00 63 00 74 00 69 00 76 00 65 00 20 00 42 00 6f 00 74 00 20 00 4b 00 69 00 6c 00 6c 00 65 00 72 00 20 00 45 00 6e 00 61 00 62 00 6c 00 65 00 64 00 21 00}
		$h = {((50 6c 61 73 6d 61 52 41 54) | (50 00 6c 00 61 00 73 00 6d 00 61 00 52 00 41 00 54 00))}
		$i = {((41 6e 74 69 45 76 65 72 79 74 68 69 6e 67) | (41 00 6e 00 74 00 69 00 45 00 76 00 65 00 72 00 79 00 74 00 68 00 69 00 6e 00 67 00))}

	condition:
		all of them
}

rule RAT_PredatorPain : hardened
{
	meta:
		author = "Kevin Breen <kevin@techanarchy.net>"
		date = "01.04.2014"
		description = "Detects PredatorPain RAT"
		reference = "http://malwareconfig.com/stats/PredatorPain"
		maltype = "Remote Access Trojan"
		filetype = "exe"
		score = 60
		id = "c6670179-871d-5a57-983b-d77354e2ede9"

	strings:
		$string1 = {68 00 6f 00 6c 00 64 00 65 00 72 00 77 00 62 00 2e 00 74 00 78 00 74 00}
		$string3 = {54 00 68 00 65 00 72 00 65 00 20 00 69 00 73 00 20 00 61 00 20 00 66 00 69 00 6c 00 65 00 20 00 61 00 74 00 74 00 61 00 63 00 68 00 65 00 64 00 20 00 74 00 6f 00 20 00 74 00 68 00 69 00 73 00 20 00 65 00 6d 00 61 00 69 00 6c 00}
		$string4 = {73 00 63 00 72 00 65 00 65 00 6e 00 73 00 5c 00 73 00 63 00 72 00 65 00 65 00 6e 00 73 00 68 00 6f 00 74 00}
		$string5 = {44 00 69 00 73 00 61 00 62 00 6c 00 65 00 6c 00 6f 00 67 00 67 00 65 00 72 00}
		$string6 = {5c 00 70 00 69 00 64 00 6c 00 6f 00 63 00 2e 00 74 00 78 00 74 00}
		$string7 = {63 00 6c 00 65 00 61 00 72 00 69 00 65 00}
		$string8 = {63 00 6c 00 65 00 61 00 72 00 66 00 66 00}
		$string9 = {65 00 6d 00 61 00 69 00 6c 00 73 00 20 00 73 00 68 00 6f 00 75 00 6c 00 64 00 20 00 62 00 65 00 20 00 73 00 65 00 6e 00 74 00 20 00 74 00 6f 00 20 00 79 00 6f 00 75 00 20 00 73 00 68 00 6f 00 72 00 74 00 6c 00 79 00}
		$string10 = {6a 00 61 00 67 00 65 00 78 00 5f 00 63 00 61 00 63 00 68 00 65 00 5c 00 72 00 65 00 67 00 50 00 69 00 6e 00}
		$string11 = {6f 00 70 00 65 00 6e 00 3d 00 53 00 79 00 73 00 2e 00 65 00 78 00 65 00}
		$ver1 = {50 00 72 00 65 00 64 00 61 00 74 00 6f 00 72 00 4c 00 6f 00 67 00 67 00 65 00 72 00}
		$ver2 = {45 00 6e 00 63 00 72 00 79 00 70 00 74 00 65 00 64 00 43 00 72 00 65 00 64 00 65 00 6e 00 74 00 69 00 61 00 6c 00 73 00}
		$ver3 = {50 00 72 00 65 00 64 00 61 00 74 00 6f 00 72 00 20 00 50 00 61 00 69 00 6e 00}

	condition:
		7 of ( $string* ) and any of ( $ver* )
}

rule RAT_Punisher : hardened
{
	meta:
		author = "Kevin Breen <kevin@techanarchy.net>"
		date = "01.04.2014"
		description = "Detects Punisher RAT"
		reference = "http://malwareconfig.com/stats/Punisher"
		maltype = "Remote Access Trojan"
		filetype = "exe"
		id = "1e16b3c7-9656-5570-afa2-542367aa14d8"

	strings:
		$a = {61 62 63 63 62 61}
		$b = {5C 00 68 00 66 00 68 00 2E 00 76 00 62 00 73}
		$c = {5C 00 73 00 63 00 2E 00 76 00 62 00 73}
		$d = {((53 70 79 54 68 65 53 70 79) | (53 00 70 00 79 00 54 00 68 00 65 00 53 00 70 00 79 00))}
		$e = {77 00 69 00 72 00 65 00 73 00 68 00 61 00 72 00 6b 00}
		$f = {61 00 70 00 61 00 74 00 65 00 44 00 4e 00 53 00}
		$g = {61 62 63 63 62 61 44 61 6e 61 62 63 63 62}

	condition:
		all of them
}

rule RAT_PythoRAT : hardened
{
	meta:
		author = "Kevin Breen <kevin@techanarchy.net>"
		date = "01.04.2014"
		description = "Detects Python RAT"
		reference = "http://malwareconfig.com/stats/PythoRAT"
		maltype = "Remote Access Trojan"
		filetype = "exe"
		id = "fc98c513-1abf-5331-b351-f6182e5b19c5"

	strings:
		$a = {54 4b 65 79 6c 6f 67 67 65 72}
		$b = {75 46 69 6c 65 54 72 61 6e 73 66 65 72}
		$c = {54 54 44 6f 77 6e 6c 6f 61 64}
		$d = {53 45 54 54 49 4e 47 53}
		$e = {55 00 6e 00 6b 00 6e 00 6f 00 77 00 6e 00}
		$f = {23 40 23 40 23}
		$g = {50 6c 75 67 69 6e 44 61 74 61}
		$i = {4f 6e 50 6c 75 67 69 6e 4d 65 73 73 61 67 65}

	condition:
		all of them
}

rule RAT_QRat : hardened
{
	meta:
		author = "Kevin Breen @KevTheHermit"
		date = "01.08.2015"
		description = "Detects QRAT"
		reference = "http://malwareconfig.com"
		maltype = "Remote Access Trojan"
		filetype = "jar"
		id = "2ee645a3-1e01-513c-a636-098e445adeca"

	strings:
		$a0 = {65 2d 64 61 74 61}
		$a1 = {71 75 61 76 65 72 73 65 2f 63 72 79 70 74 65 72}
		$a2 = {51 72 79 70 74 2e 63 6c 61 73 73}
		$a3 = {4a 61 72 69 7a 65 72 2e 63 6c 61 73 73}
		$a4 = {55 52 4c 43 6f 6e 6e 65 63 74 69 6f 6e 2e 63 6c 61 73 73}

	condition:
		4 of them
}

rule RAT_Sakula : hardened
{
	meta:
		date = "2015-10-13"
		description = "Detects Sakula v1.0 RAT"
		author = "Airbus Defence and Space Cybersecurity CSIRT - Yoann Francou / NCC Group David Cannings"
		reference = "http://blog.airbuscybersecurity.com/public/YFR/sakula_v1x.yara"
		id = "4be3179c-3b91-56db-bba9-9ccc42066f96"

	strings:
		$s1 = {25 64 5f 6f 66 5f 25 64 5f 66 6f 72 5f 25 73 5f 6f 6e 5f 25 73}
		$s2 = {2f 63 20 70 69 6e 67 20 31 32 37 2e 30 2e 30 2e 31 20 26 20 64 65 6c 20 2f 71 20 22 25 73 22}
		$s3 = {3d 25 73 26 74 79 70 65 3d 25 64}
		$s4 = {3f 70 68 6f 74 6f 69 64 3d}
		$s5 = {69 65 78 70 6c 6f 72 65 72}
		$s6 = {6e 65 74 20 73 74 61 72 74 20 22 25 73 22}
		$s7 = {63 6d 64 2e 65 78 65 20 2f 63 20 72 75 6e 64 6c 6c 33 32 20 22 25 73 22}
		$v1_1 = {4d 69 63 72 6f 50 6c 61 79 65 72 55 70 64 61 74 65 2e 65 78 65}
		$v1_2 = {43 43 50 55 70 64 61 74 65}
		$v1_3 = { 81 3E 78 03 00 00 75 57  8D 54 24 14 52 68 0C 05 41 00 68 01 00 00 80 FF  15 00 F0 40 00 85 C0 74 10 8B 44 24 14 68 2C 31  41 00 50 FF 15 10 F0 40 00 8B 4C 24 14 51 FF 15  24 F0 40 00 E8 0F 09 00 }
		$v1_4 = { 50 E8 CD FC FF FF 83 C4  04 68 E8 03 00 00 FF D7 56 E8 54 12 00 00 E9 AE  FE FF FF E8 13 F5 FF FF }
		$serial01 = { 31 06 2e 48 3e 01 06 b1 8c 98 2f 00 53 18 5c 36 }
		$serial02 = { 01 a5 d9 59 95 19 b1 ba fc fa d0 e8 0b 6d 67 35 }
		$serial03 = { 47 d5 d5 37 2b cb 15 62 b4 c9 f4 c2 bd f1 35 87 }
		$serial04 = { 3a c1 0e 68 f1 ce 51 9e 84 dd cd 28 b1 1f a5 42 }
		$opcodes1 = { 89 FF 55 89 E5 83 EC 20 A1 ?? ?? ?? 00 83 F8 00 }
		$opcodes2 = { 31 C0 8A 04 0B 3C 00 74 09 38 D0 74 05 30 D0 88 04 0B }
		$opcodes3 = { 8B 45 08 8D 0C 02 8A 01 84 C0 74 08 3C ?? 74 04 34 ?? 88 01 }
		$opcodes4 = { 30 14 38 8D 0C 38 40 FE C2 3B C6 }
		$opcodes5 = { 30 14 39 8D 04 39 41 FE C2 3B CE }
		$fp1 = {((53 79 6d 61 6e 74 65 63 20 43 6f 72 70 6f 72 61 74 69 6f 6e) | (53 00 79 00 6d 00 61 00 6e 00 74 00 65 00 63 00 20 00 43 00 6f 00 72 00 70 00 6f 00 72 00 61 00 74 00 69 00 6f 00 6e 00))}

	condition:
		uint16( 0 ) == 0x5a4d and ( ( 3 of ( $s* ) and any of ( $v1_* ) ) or ( any of ( $serial0* ) ) or ( any of ( $opcodes* ) ) ) and not 1 of ( $fp* )
}

rule RAT_ShadowTech : FILE hardened limited
{
	meta:
		author = "Kevin Breen <kevin@techanarchy.net>"
		date = "01.04.2014"
		description = "Detects ShadowTech RAT"
		reference = "http://malwareconfig.com/stats/ShadowTech"
		maltype = "Remote Access Trojan"
		filetype = "exe"
		id = "1fb15030-b400-5e70-b183-81e2527d5556"

	strings:
		$a = {53 68 61 64 6f 77 54 65 63 68}
		$b = {44 6f 77 6e 6c 6f 61 64 43 6f 6e 74 61 69 6e 65 72}
		$c = {4d 79 53 65 74 74 69 6e 67 73}
		$d = {53 79 73 74 65 6d 2e 43 6f 6e 66 69 67 75 72 61 74 69 6f 6e}
		$newline = {23 00 2d 00 40 00 4e 00 65 00 77 00 4c 00 69 00 6e 00 65 00 40 00 2d 00 23 00}
		$split = {70 00 53 00 49 00 4c 00}
		$key = {45 00 53 00 49 00 4c 00}

	condition:
		4 of them
}

rule ShadowTech_2 : hardened
{
	meta:
		description = "ShadowTech RAT"
		author = "botherder https://github.com/botherder"

	strings:
		$string1 = /\#(S)trings/
		$string2 = /\#(G)UID/
		$string3 = /\#(B)lob/
		$string4 = /(S)hadowTech Rat\.exe/
		$string5 = /(S)hadowTech_Rat/

	condition:
		all of them
}

rule RAT_SmallNet : hardened
{
	meta:
		author = "Kevin Breen <kevin@techanarchy.net>"
		date = "01.04.2014"
		description = "Detects SmallNet RAT"
		reference = "http://malwareconfig.com/stats/SmallNet"
		maltype = "Remote Access Trojan"
		filetype = "exe"
		id = "aec1f8fd-2806-527e-9d50-422f212864de"

	strings:
		$split1 = {21 21 3c 33 53 41 46 49 41 3c 33 21 21}
		$split2 = {21 21 45 6c 4d 61 74 74 61 64 6f 72 44 7a 21 21}
		$a1 = {73 74 75 62 5f 32 2e 50 72 6f 70 65 72 74 69 65 73}
		$a2 = {73 00 74 00 75 00 62 00 2e 00 65 00 78 00 65 00}
		$a3 = {67 65 74 5f 43 75 72 72 65 6e 74 44 6f 6d 61 69 6e}

	condition:
		($split1 or $split2 ) and ( all of ( $a* ) )
}

rule RAT_SpyGate : hardened limited
{
	meta:
		author = "Kevin Breen <kevin@techanarchy.net>"
		date = "01.04.2014"
		description = "Detects SpyGate RAT"
		reference = "http://malwareconfig.com/stats/SpyGate"
		maltype = "Remote Access Trojan"
		filetype = "exe"
		score = 75
		id = "ed015770-81ff-5d9c-8bd0-3c225e400724"

	strings:
		$split = {61 62 63 63 62 61}
		$a1 = {61 62 63 63 62 61 53 70 79 47 61 74 65 52 41 54 61 62 63 63 62 61}
		$a2 = {53 74 75 62 58 2e 70 64 62}
		$a3 = {61 62 63 63 62 61 44 61 6e 61 62 63 63 62}
		$b1 = {6d 6f 6e 69 6b 65 72 53 74 72 69 6e 67}
		$b2 = {76 69 72 75 73 74 6f 74 61 6c 31}
		$b3 = {67 65 74 5f 43 75 72 72 65 6e 74 44 6f 6d 61 69 6e}
		$c1 = {73 00 68 00 75 00 74 00 64 00 6f 00 77 00 6e 00 63 00 6f 00 6d 00 70 00 75 00 74 00 65 00 72 00}
		$c2 = {73 00 68 00 75 00 74 00 64 00 6f 00 77 00 6e 00 20 00 2d 00 72 00 20 00 2d 00 74 00 20 00 30 00 30 00}
		$c3 = {73 00 65 00 74 00 20 00 63 00 64 00 61 00 75 00 64 00 69 00 6f 00 20 00 64 00 6f 00 6f 00 72 00 20 00 63 00 6c 00 6f 00 73 00 65 00 64 00}
		$c4 = {46 00 69 00 6c 00 65 00 4d 00 61 00 6e 00 61 00 67 00 65 00 72 00 53 00 70 00 6c 00 69 00 74 00}
		$c5 = {43 00 68 00 61 00 74 00 69 00 6e 00 67 00 20 00 57 00 69 00 74 00 68 00 20 00 3e 00 3e 00 20 00 5b 00 7e 00 48 00 61 00 63 00 6b 00 65 00 72 00 7e 00 5d 00}

	condition:
		( all of ( $a* ) and #split > 40 ) or ( all of ( $b* ) and #split > 10 ) or ( all of ( $c* ) )
}

rule RAT_Sub7Nation : hardened
{
	meta:
		author = "Kevin Breen <kevin@techanarchy.net> (slightly modified by Florian Roth to improve performance)"
		date = "01.04.2014"
		description = "Detects Sub7Nation RAT"
		reference = "http://malwareconfig.com/stats/Sub7Nation"
		maltype = "Remote Access Trojan"
		filetype = "exe"
		id = "4f41d649-4a90-566b-bda8-0a288380aeaa"

	strings:
		$a = {45 6e 61 62 6c 65 4c 55 41 20 2f 74 20 52 45 47 5f 44 57 4f 52 44 20 2f 64 20 30 20 2f 66}
		$i = {48 6f 73 74 53 65 74 74 69 6e 67 73}
		$verSpecific1 = {73 65 76 61 6e 65 2e 74 6d 70}
		$verSpecific2 = {63 6d 64 5f 2e 62 61 74}
		$verSpecific3 = {61 32 62 37 63 33 64 37 65 34}
		$verSpecific4 = {63 6d 64 2e 64 6c 6c}

	condition:
		all of them
}

rule RAT_Vertex : hardened
{
	meta:
		author = "Kevin Breen <kevin@techanarchy.net>"
		date = "01.04.2014"
		description = "Detects Vertex RAT"
		reference = "http://malwareconfig.com/stats/Vertex"
		maltype = "Remote Access Trojan"
		filetype = "exe"
		id = "f6f5967e-6b88-5d95-8fe1-a286ee8ce64c"

	strings:
		$string1 = {44 45 46 50 41 54 48}
		$string2 = {48 4b 4e 41 4d 45}
		$string3 = {48 50 4f 52 54}
		$string4 = {49 4e 53 54 41 4c 4c}
		$string5 = {49 50 41 54 48}
		$string6 = {4d 55 54 45 58}
		$res1 = {50 41 4e 45 4c 50 41 54 48}
		$res2 = {52 4f 4f 54 55 52 4c}

	condition:
		all of them
}

rule RAT_VirusRat : hardened
{
	meta:
		author = "Kevin Breen <kevin@techanarchy.net>"
		date = "01.04.2014"
		score = 60
		description = "Detects VirusRAT"
		reference = "http://malwareconfig.com/stats/VirusRat"
		maltype = "Remote Access Trojan"
		filetype = "exe"
		id = "ef00cec9-d09b-5010-8e7d-bb391c937f34"

	strings:
		$string0 = {76 69 72 75 73 74 6f 74 61 6c}
		$string1 = {76 69 72 75 73 73 63 61 6e}
		$string2 = {61 62 63 63 62 61}
		$string3 = {70 72 6f 6e 6f 69 70}
		$string4 = {73 74 72 65 61 6d 57 65 62 63 61 6d}
		$string5 = {44 4f 4d 41 49 4e 5f 50 41 53 53 57 4f 52 44}
		$string6 = {53 74 75 62 2e 46 6f 72 6d 31 2e 72 65 73 6f 75 72 63 65 73}
		$string7 = {66 00 74 00 70 00 3a 00 2f 00 2f 00 7b 00 30 00 7d 00 40 00 7b 00 31 00 7d 00}
		$string8 = {53 00 45 00 4c 00 45 00 43 00 54 00 20 00 2a 00 20 00 46 00 52 00 4f 00 4d 00 20 00 6d 00 6f 00 7a 00 5f 00 6c 00 6f 00 67 00 69 00 6e 00 73 00}
		$string9 = {53 00 45 00 4c 00 45 00 43 00 54 00 20 00 2a 00 20 00 46 00 52 00 4f 00 4d 00 20 00 6d 00 6f 00 7a 00 5f 00 64 00 69 00 73 00 61 00 62 00 6c 00 65 00 64 00 48 00 6f 00 73 00 74 00 73 00}
		$string10 = {44 00 79 00 6e 00 44 00 4e 00 53 00 5c 00 55 00 70 00 64 00 61 00 74 00 65 00 72 00 5c 00 63 00 6f 00 6e 00 66 00 69 00 67 00 2e 00 64 00 79 00 6e 00 64 00 6e 00 73 00}
		$string11 = {7c 00 42 00 61 00 77 00 61 00 6e 00 65 00 48 00 7c 00}

	condition:
		all of them
}

rule RAT_Xtreme : hardened
{
	meta:
		author = "Kevin Breen <kevin@techanarchy.net>"
		date = "01.04.2014"
		description = "Detects Xtreme RAT"
		reference = "http://malwareconfig.com/stats/Xtreme"
		maltype = "Remote Access Trojan"
		filetype = "exe"
		ver = "2.9, 3.1, 3.2, 3.5"
		id = "02b7bb6a-5d1e-5379-b366-868680844719"

	strings:
		$a = {58 00 54 00 52 00 45 00 4d 00 45 00}
		$b = {53 00 65 00 72 00 76 00 65 00 72 00 53 00 74 00 61 00 72 00 74 00 65 00 64 00}
		$c = {58 00 74 00 72 00 65 00 6d 00 65 00 4b 00 65 00 79 00 6c 00 6f 00 67 00 67 00 65 00 72 00}
		$d = {78 00 2e 00 68 00 74 00 6d 00 6c 00}
		$e = {58 00 74 00 72 00 65 00 6d 00 65 00 20 00 52 00 41 00 54 00}

	condition:
		all of them
}

rule RAT_adWind : hardened
{
	meta:
		author = "Kevin Breen <kevin@techanarchy.net>"
		date = "01.04.2014"
		description = "Detects Adwind RAT"
		reference = "http://malwareconfig.com/stats/adWind"
		maltype = "Remote Access Trojan"
		filetype = "exe"
		score = 75
		id = "95681c07-0e9c-5688-a8a0-899617521c7b"

	strings:
		$meta = {4d 45 54 41 2d 49 4e 46}
		$conf = {63 6f 6e 66 69 67 2e 78 6d 6c}
		$a = {41 64 77 69 6e 64 2e 63 6c 61 73 73}
		$b = {50 72 69 6e 63 69 70 61 6c 2e 61 64 77 69 6e 64}

	condition:
		all of them
}

rule RAT_unrecom : hardened
{
	meta:
		author = "Kevin Breen <kevin@techanarchy.net>"
		date = "01.04.2014"
		description = "Detects unrecom RAT"
		reference = "http://malwareconfig.com/stats/unrecom"
		maltype = "Remote Access Trojan"
		filetype = "exe"
		id = "56b11c22-f43c-5192-9a0a-0ac14b0cd041"

	strings:
		$meta = {4d 45 54 41 2d 49 4e 46}
		$conf = {6c 6f 61 64 2f 49 44}
		$a = {6c 6f 61 64 2f 4a 61 72 4d 61 69 6e 2e 63 6c 61 73 73}
		$b = {6c 6f 61 64 2f 4d 41 4e 49 46 45 53 54 2e 4d 46}
		$c = {70 6c 75 67 69 6e 73 2f 55 6e 72 65 63 6f 6d 53 65 72 76 65 72 2e 63 6c 61 73 73}

	condition:
		all of them
}

rule MAL_JRAT_Oct18_1 : hardened
{
	meta:
		description = "Detects JRAT malware"
		author = "Florian Roth (Nextron Systems)"
		reference = "Internal Research"
		date = "2018-10-11"
		score = 60
		hash1 = "ce190c37a6fdb2632f4bc5ea0bb613b3fbe697d04e68e126b41910a6831d3411"
		id = "f211ef1c-8def-55f0-8817-d01ebd9c2947"

	strings:
		$x1 = {2f 4a 52 61 74 2e 63 6c 61 73 73}

	condition:
		uint16( 0 ) == 0x4b50 and filesize < 700KB and 1 of them
}

