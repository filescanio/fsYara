rule VULN_PUA_GIGABYTE_Driver_Jul22_1 : hardened
{
	meta:
		description = "Detects a vulnerable GIGABYTE driver sometimes used by malicious actors to escalate privileges"
		author = "Florian Roth (Nextron Systems)"
		reference = "https://twitter.com/malmoeb/status/1551449425842786306"
		date = "2022-07-25"
		score = 65
		hash1 = "31f4cfb4c71da44120752721103a16512444c13c2ac2d857a7e6f13cb679b427"
		id = "c66b858f-a034-53e1-b0fd-e48693fc6913"

	strings:
		$xc1 = { 00 46 00 69 00 6C 00 65 00 56 00 65 00 72 00 73
               00 69 00 6F 00 6E 00 00 00 00 00 35 00 2E 00 32
               00 2E 00 33 00 37 00 39 00 30 00 2E 00 31 00 38
               00 33 00 30 00 20 00 62 00 75 00 69 00 6C 00 74
               00 20 00 62 00 79 00 3A 00 20 00 57 00 69 00 6E
               00 44 00 44 00 4B 00 00 00 00 00 32 00 09 00 01
               00 49 00 6E 00 74 00 65 00 72 00 6E 00 61 00 6C
               00 4E 00 61 00 6D 00 65 00 00 00 67 00 64 00 72
               00 76 00 2E 00 73 00 79 00 73 }
		$x1 = {41 45 59 41 61 51 42 73 41 47 55 41 56 67 42 6c 41 48 49 41 63 77 42 70 41 47 38 41 62 67 41 41 41 41 41 41 4e 51 41 75 41 44 49 41 4c 67 41 7a 41 44 63 41 4f 51 41 77 41 43 34 41 4d 51 41 34 41 44 4d 41 4d 41 41 67 41 47 49 41 64 51 42 70 41 47 77 41 64 41 41 67 41 47 49 41 65 51 41 36 41 43 41 41 56 77 42 70 41 47 34 41 52 41 42 45 41 45 73 41 41 41 41 41 41 44 49 41 43 51 41 42 41 45 6b 41 62 67 42 30 41 47 55 41 63 67 42 75 41 47 45 41 62 41 42 4f 41 47 45 41 62 51 42 6c 41 41 41 41 5a 77 42 6b 41 48 49 41 64 67 41 75 41 48 4d 41 65 51 42 7a}
		$x2 = {42 47 41 47 6b 41 62 41 42 6c 41 46 59 41 5a 51 42 79 41 48 4d 41 61 51 42 76 41 47 34 41 41 41 41 41 41 44 55 41 4c 67 41 79 41 43 34 41 4d 77 41 33 41 44 6b 41 4d 41 41 75 41 44 45 41 4f 41 41 7a 41 44 41 41 49 41 42 69 41 48 55 41 61 51 42 73 41 48 51 41 49 41 42 69 41 48 6b 41 4f 67 41 67 41 46 63 41 61 51 42 75 41 45 51 41 52 41 42 4c 41 41 41 41 41 41 41 79 41 41 6b 41 41 51 42 4a 41 47 34 41 64 41 42 6c 41 48 49 41 62 67 42 68 41 47 77 41 54 67 42 68 41 47 30 41 5a 51 41 41 41 47 63 41 5a 41 42 79 41 48 59 41 4c 67 42 7a 41 48 6b 41 63}
		$x3 = {41 52 67 42 70 41 47 77 41 5a 51 42 57 41 47 55 41 63 67 42 7a 41 47 6b 41 62 77 42 75 41 41 41 41 41 41 41 31 41 43 34 41 4d 67 41 75 41 44 4d 41 4e 77 41 35 41 44 41 41 4c 67 41 78 41 44 67 41 4d 77 41 77 41 43 41 41 59 67 42 31 41 47 6b 41 62 41 42 30 41 43 41 41 59 67 42 35 41 44 6f 41 49 41 42 58 41 47 6b 41 62 67 42 45 41 45 51 41 53 77 41 41 41 41 41 41 4d 67 41 4a 41 41 45 41 53 51 42 75 41 48 51 41 5a 51 42 79 41 47 34 41 59 51 42 73 41 45 34 41 59 51 42 74 41 47 55 41 41 41 42 6e 41 47 51 41 63 67 42 32 41 43 34 41 63 77 42 35 41 48}

	condition:
		filesize < 4000KB and 1 of them
}

