rule Malware_QA_not_copy : hardened
{
	meta:
		description = "VT Research QA uploaded malware - file not copy.exe"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		author = "Florian Roth (Nextron Systems)"
		reference = "VT Research QA"
		date = "2016-08-29"
		score = 80
		hash1 = "1410f38498567b64a4b984c69fe4f2859421e4ac598b9750d8f703f1d209f836"
		id = "d618389b-ec80-5ad1-be44-4b1f3e36c07d"

	strings:
		$x1 = {55 00 32 00 56 00 79 00 64 00 6d 00 56 00 79 00 4c 00 6d 00 56 00 34 00 5a 00 51 00 3d 00 3d 00}
		$x2 = {5c 6e 6f 74 20 63 6f 70 79 5c 6f 62 6a 5c 44 65 62 75 67 5c 6e 6f 74 20 63 6f 70 79 2e 70 64 62}
		$x3 = {66 00 75 00 63 00 6b 00 79 00 6f 00 75 00 38 00 38 00 38 00 2e 00 64 00 64 00 6e 00 73 00 2e 00 6e 00 65 00 74 00}
		$s1 = {63 00 6d 00 64 00 2e 00 65 00 78 00 65 00 20 00 2f 00 63 00 20 00 70 00 69 00 6e 00 67 00 20 00 30 00 20 00 2d 00 6e 00 20 00 32 00 20 00 26 00 20 00 64 00 65 00 6c 00 20 00 22 00}
		$s2 = {53 00 65 00 72 00 76 00 65 00 72 00 2e 00 65 00 78 00 65 00}
		$s3 = {45 00 78 00 65 00 63 00 75 00 74 00 65 00 20 00 45 00 52 00 52 00 4f 00 52 00}
		$s4 = {6e 00 6f 00 74 00 20 00 63 00 6f 00 70 00 79 00 2e 00 65 00 78 00 65 00}
		$s5 = {4e 00 6f 00 6e 00 20 00 48 00 6f 00 73 00 54 00}
		$s6 = {6e 00 65 00 74 00 73 00 68 00 20 00 66 00 69 00 72 00 65 00 77 00 61 00 6c 00 6c 00 20 00 64 00 65 00 6c 00 65 00 74 00 65 00 20 00 61 00 6c 00 6c 00 6f 00 77 00 65 00 64 00 70 00 72 00 6f 00 67 00 72 00 61 00 6d 00}

	condition:
		( uint16( 0 ) == 0x5a4d and filesize < 1000KB and ( 1 of ( $x* ) or 4 of ( $s* ) ) ) or ( 5 of them )
}

rule Malware_QA_update : hardened
{
	meta:
		description = "VT Research QA uploaded malware - file update.exe"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		author = "Florian Roth (Nextron Systems)"
		reference = "VT Research QA"
		date = "2016-08-29"
		score = 80
		hash1 = "6d805533623d7063241620eec38b7eb9b625533ccadeaf4f6c2cc6db32711541"
		hash2 = "6415b45f5bae6429dd5d92d6cae46e8a704873b7090853e68e80cd179058903e"
		id = "1dce684d-33b0-5588-8325-2a34c0cde32f"

	strings:
		$x1 = {55 6e 41 63 74 69 76 65 4f 66 66 6c 69 6e 65 4b 65 79 6c 6f 67 67 65 72}
		$x2 = {42 54 52 45 53 55 4c 54 44 6f 77 6e 6c 6f 61 64 20 46 69 6c 65 7c 4d 61 73 73 20 44 6f 77 6e 6c 6f 61 64 20 3a 20 46 69 6c 65 20 44 6f 77 6e 6c 6f 61 64 65 64 20 2c 20 45 78 65 63 75 74 69 6e 67 20 6e 65 77 20 6f 6e 65 20 69 6e 20 74 65 6d 70 20 64 69 72 2e 2e 2e 7c}
		$x3 = {41 63 74 69 76 65 4f 6e 6c 69 6e 65 4b 65 79 6c 6f 67 67 65 72}
		$x4 = {43 3a 5c 55 73 65 72 73 5c 44 61 72 6b 43 6f 64 65 72 53 63 5c}
		$x5 = {43 65 6c 65 73 74 79 20 42 69 6e 64 65 72 5c 53 74 75 62 5c 53 54 41 54 49 43 5c 53 74 75 62 2e 70 64 62}
		$x6 = {42 54 52 45 53 55 4c 54 55 70 64 61 74 65 20 66 72 6f 6d 20 55 52 4c 7c 55 70 64 61 74 65 20 3a 20 46 69 6c 65 20 44 6f 77 6e 6c 6f 61 64 65 64 20 2c 20 45 78 65 63 75 74 69 6e 67 20 6e 65 77 20 6f 6e 65 20 69 6e 20 74 65 6d 70 20 64 69 72 2e 2e 2e 7c}
		$s1 = {4d 00 53 00 52 00 53 00 41 00 41 00 50 00 2e 00 45 00 58 00 45 00}
		$s2 = {43 6f 6d 6d 61 6e 64 20 73 75 63 63 65 73 73 66 75 6c 6c 79 20 65 78 65 63 75 74 65 64 21 7c}
		$s3 = {42 54 4d 65 6d 6f 72 79 4c 6f 61 64 4c 69 62 61 72 79 3a 20 47 65 74 20 44 4c 4c 45 6e 74 79 50 6f 69 6e 74 20 66 61 69 6c 65 64}
		$s4 = {49 20 77 61 73 6e 27 74 20 61 62 6c 65 20 74 6f 20 6f 70 65 6e 20 74 68 65 20 68 6f 73 74 73 20 66 69 6c 65 2c 20 6d 61 79 62 65 20 62 65 63 61 75 73 65 20 55 41 43 20 69 73 20 65 6e 61 62 6c 65 64 20 69 6e 20 72 65 6d 6f 74 65 20 63 6f 6d 70 75 74 65 72 21}
		$s5 = {5c 49 6e 74 65 72 6e 65 74 20 45 78 70 6c 6f 72 65 72 5c 69 65 78 70 6c 6f 72 65 2e 65 78 65}
		$s6 = {70 69 6e 67 20 31 32 37 2e 30 2e 30 2e 31 20 2d 6e 20 34 20 3e 20 4e 55 4c 20 26 26 20 22}
		$s7 = {42 54 4d 65 6d 6f 72 79 47 65 74 50 72 6f 63 41 64 64 72 65 73 73 3a 20 44 4c 4c 20 64 6f 65 73 6e 27 74 20 65 78 70 6f 72 74 20 61 6e 79 74 68 69 6e 67}
		$s8 = {50 4f 53 54 20 2f 69 6e 64 65 78 2e 70 68 70 2f 31 2e 30}

	condition:
		( uint16( 0 ) == 0x5a4d and filesize < 3000KB and ( 1 of ( $x* ) or 3 of ( $s* ) ) ) or ( all of them )
}

rule Malware_QA_tls : hardened
{
	meta:
		description = "VT Research QA uploaded malware - file tls.exe"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		author = "Florian Roth (Nextron Systems)"
		reference = "VT Research QA"
		date = "2016-08-29"
		score = 80
		hash1 = "f06d1f2bee2eb6590afbfa7f011ceba9bd91ba31cdc721bc728e13b547ac9370"
		id = "b3b654b1-73cf-5e04-a332-34777f646a66"

	strings:
		$s1 = {5c 66 75 6e 6f 76 65 72 69 70 5c 75 6c 74 69 6d 61 74 65 2d 70 61 79 6c 6f 61 64 2d 74 65 6d 70 6c 61 74 65 31 5c}
		$s2 = {55 00 4c 00 54 00 49 00 4d 00 41 00 54 00 45 00 50 00 41 00 59 00 4c 00 4f 00 41 00 44 00 54 00 45 00 4d 00 50 00 4c 00 41 00 54 00 45 00 31 00}
		$s3 = {75 00 6c 00 74 00 69 00 6d 00 61 00 74 00 65 00 2d 00 70 00 61 00 79 00 6c 00 6f 00 61 00 64 00 2d 00 74 00 65 00 6d 00 70 00 6c 00 61 00 74 00 65 00 31 00}

	condition:
		( uint16( 0 ) == 0x5a4d and filesize < 300KB and 1 of them ) or ( all of them )
}

rule Malware_QA_get_The_FucKinG_IP : hardened
{
	meta:
		description = "VT Research QA uploaded malware - file get The FucKinG IP.exe"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		author = "Florian Roth (Nextron Systems)"
		reference = "VT Research QA"
		date = "2016-08-29"
		score = 80
		hash1 = "7b2c04e384919075be96e3412d92c14fc1165d1bc7556fd207488959c5c4d2f7"
		id = "1c992fc5-79cf-532c-a18b-cfcc3406d6ed"

	strings:
		$x1 = {43 3a 5c 55 73 65 72 73 5c 4d 64 72 61 6d 20 61 68 6d 65 64 5c 41 70 70 44 61 74 61}
		$x2 = {5c 4c 6f 63 61 6c 5c 54 65 6d 70 6f 72 61 72 79 20 50 72 6f 6a 65 63 74 73 5c 67 65 74 20 54 68 65 20 46 75 63 4b 69 6e 47 20 49 50 5c}
		$x3 = {67 00 65 00 74 00 20 00 54 00 68 00 65 00 20 00 46 00 75 00 63 00 4b 00 69 00 6e 00 47 00 20 00 49 00 50 00 2e 00 65 00 78 00 65 00}
		$x4 = {67 00 65 00 74 00 20 00 69 00 70 00 20 00 62 00 79 00 20 00 6d 00 64 00 72 00 33 00 6d 00}
		$x5 = {4d 00 44 00 52 00 33 00 4d 00 20 00 6b 00 69 00 6b 00 3a 00 20 00 4d 00 64 00 72 00 33 00 6d 00 68 00 6d 00}

	condition:
		( uint16( 0 ) == 0x5a4d and filesize < 1000KB and 1 of ( $x* ) ) or ( 2 of them )
}

rule Malware_QA_vqgk : hardened
{
	meta:
		description = "VT Research QA uploaded malware - file vqgk.dll"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		author = "Florian Roth (Nextron Systems)"
		reference = "VT Research QA"
		date = "2016-08-29"
		modified = "2022-12-21"
		score = 80
		hash1 = "99541ab28fc3328e25723607df4b0d9ea0a1af31b58e2da07eff9f15c4e6565c"
		id = "9246d9de-92e5-5cb8-857c-1e222c3d74d5"

	strings:
		$x1 = {5a 3a 5c 64 65 76 63 65 6e 74 65 72 5c 61 67 67 72 65 73 73 6f 72 5c 65 78 74 65 72 6e 61 6c}
		$x2 = {5c 62 65 61 63 6f 6e 5c 52 65 6c 65 61 73 65 5c 62 65 61 63 6f 6e 2e 70 64 62}
		$x3 = {25 64 20 69 73 20 61 6e 20 78 38 36 20 70 72 6f 63 65 73 73 20 28 63 61 6e 27 74 20 69 6e 6a 65 63 74 20 78 36 34 20 63 6f 6e 74 65 6e 74 29}
		$x4 = {25 64 20 69 73 20 61 6e 20 78 36 34 20 70 72 6f 63 65 73 73 20 28 63 61 6e 27 74 20 69 6e 6a 65 63 74 20 78 38 36 20 63 6f 6e 74 65 6e 74 29}
		$s1 = {70 6f 77 65 72 73 68 65 6c 6c 20 2d 6e 6f 70 20 2d 65 78 65 63 20 62 79 70 61 73 73 20 2d 45 6e 63 6f 64 65 64 43 6f 6d 6d 61 6e 64 20 22 25 73 22}
		$s2 = {43 6f 75 6c 64 20 6e 6f 74 20 6f 70 65 6e 20 70 72 6f 63 65 73 73 20 74 6f 6b 65 6e 3a 20 25 64 20 28 25 75 29}
		$s3 = {5c 5c 25 73 5c 70 69 70 65 5c 6d 73 61 67 65 6e 74 5f 25 78}
		$s4 = {5c 73 79 73 6e 61 74 69 76 65 5c 72 75 6e 64 6c 6c 33 32 2e 65 78 65}
		$s5 = {46 61 69 6c 65 64 20 74 6f 20 69 6d 70 65 72 73 6f 6e 61 74 65 20 6c 6f 67 67 65 64 20 6f 6e 20 75 73 65 72 20 25 64 20 28 25 75 29}
		$s6 = {49 45 58 20 28 4e 65 77 2d 4f 62 6a 65 63 74 20 4e 65 74 2e 57 65 62 63 6c 69 65 6e 74 29 2e 44 6f 77 6e 6c 6f 61 64 53 74 72 69 6e 67 28 27 68 74 74 70 3a 2f 2f 31 32 37 2e 30 2e 30 2e 31 3a 25 75 2f 27 29 3b 20 25 73}
		$s7 = {63 6f 75 6c 64 20 6e 6f 74 20 77 72 69 74 65 20 74 6f 20 70 72 6f 63 65 73 73 20 6d 65 6d 6f 72 79 3a 20 25 64}
		$s8 = {62 65 61 63 6f 6e 2e 64 6c 6c}
		$s9 = {46 61 69 6c 65 64 20 74 6f 20 69 6d 70 65 72 73 6f 6e 61 74 65 20 74 6f 6b 65 6e 20 66 72 6f 6d 20 25 64 20 28 25 75 29}

	condition:
		( uint16( 0 ) == 0x5a4d and filesize < 600KB and ( 1 of ( $x* ) or 5 of ( $s* ) ) ) or ( 7 of them )
}

rule Malware_QA_1177 : hardened
{
	meta:
		description = "VT Research QA uploaded malware - file 1177.vbs"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		author = "Florian Roth (Nextron Systems)"
		reference = "VT Research QA"
		date = "2016-08-29"
		score = 80
		hash1 = "ff3a2740330a6cbae7888e7066942b53015728c367cf9725e840af5b2a3fa247"
		id = "363228c1-f9f8-5319-91b2-7eabdd1ca3f8"

	strings:
		$x1 = {2e 73 70 65 63 69 61 6c 66 6f 6c 64 65 72 73 20 28 22 73 74 61 72 74 75 70 22 29 20 26 20 22 5c 53 65 72 76 65 72 4e 61 6d 65 2e 45 58 45 22}
		$x2 = {65 78 70 61 6e 64 65 6e 76 69 72 6f 6e 6d 65 6e 74 73 74 72 69 6e 67 73 28 22 25 25 49 6e 73 61 6c 6c 44 69 72 25 25 22 29 20}
		$s1 = {43 72 65 61 74 65 4f 62 6a 65 63 74 28 22 57 53 63 72 69 70 74 2e 53 68 65 6c 6c 22 29 2e 52 75 6e 28}
		$s2 = {54 56 71 51 41 41 4d 41 41 41 41 45 41 41 41 41 2f 2f 38 41 41 4c 67 41 41 41 41 41 41 41 41 41 51 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 67 41 41}
		$s3 = {63 69 61 6c 20 54 68 61 6e 6b 27 73 20 74 6f 20 44 65 76 2d 70 6f 69 6e 74 2e 63 6f 6d}
		$s4 = {2e 63 72 65 61 74 65 45 6c 65 6d 65 6e 74 28 22 74 6d 70 22 29}
		$s5 = {27 25 43 6f 70 79 54 6f 53 74 61 72 74 55 70 25}

	condition:
		( uint16( 0 ) == 0x4d27 and filesize < 100KB and ( 1 of ( $x* ) or 4 of ( $s* ) ) ) or ( 5 of them )
}

