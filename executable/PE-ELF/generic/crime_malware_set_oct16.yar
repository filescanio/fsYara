rule Unspecified_Malware_Oct16_A : hardened
{
	meta:
		description = "Detects an unspecififed malware - October 2016"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		author = "Florian Roth (Nextron Systems)"
		reference = "Internal Research"
		date = "2016-10-08"
		score = 80
		hash1 = "d112a7e21902287e4a37112bf17d7c73a7b206e7bc81780fd87991c1519f38c8"
		id = "f62ecf7e-2b66-5567-9bf3-3d3797bc582d"

	strings:
		$x1 = {25 73 5c 73 79 73 74 65 6d 33 32 5c 25 73 2e 64 6c 6c}
		$x2 = {25 53 79 73 74 65 6d 52 6f 6f 74 25 5c 53 79 73 74 65 6d 33 32 5c 73 76 63 68 25 73 20 2d 6b 20 6e 65 74 73}
		$x3 = {5c 5c 2e 5c 70 69 70 65 5c 39 36 44 42 41 32 34 39 2d 45 38 38 45 2d 34 63 34 37 2d 39 38 44 43 2d 45 31 38 45 36 45 33 45 33 45 35 41}
		$s1 = {53 4f 46 54 57 41 52 45 5c 4d 69 63 72 6f 73 6f 66 74 5c 57 69 6e 64 6f 77 73 20 4e 54 5c 43 75 72 72 65 6e 74 56 65 72 73 69 6f 6e 5c 49 6d 61 67 65 20 46 69 6c 65 20 45 78 65 63 75 74 69 6f 6e 20 4f 70 74 69 6f 6e 73}
		$s2 = {62 6f 6f 74 74 65 6d 70 2e 65 78 65}
		$s3 = {61 74 20 5c 5c 25 73 20 25 64 3a 25 64 20 43 3a 5c 25 73 2e 65 78 65}
		$s4 = {63 72 79 70 74 63 6f 6d 2e 64 6c 6c}
		$s5 = {57 69 6e 69 6e 65 74 2e 64 6c 6c}
		$s6 = {5c 5c 25 73 5c 25 73 5c 25 73 2e 65 78 65}
		$s7 = {25 73 25 64 2e 65 78 65}
		$s8 = {62 6f 6f 74 65 72 2e 65 78 65}
		$s9 = {5c 5c 25 73 5c 70 69 70 65 25 73}
		$s10 = {43 3a 5c 44 65 6c 49 6e 66 6f 2e 62 69 6e}
		$op0 = { ae 44 00 00 cb 44 00 00 dc 44 00 00 f5 44 00 00 }
		$op1 = { ae 44 00 00 cb 44 00 00 dc 44 00 00 f5 44 00 00 }
		$op2 = { ee 11 74 cf 73 0b 91 c4 c9 57 b2 d9 36 86 a5 b4 }

	condition:
		( uint16( 0 ) == 0x5a4d and filesize < 1000KB and ( 2 of ( $x* ) or 3 of ( $s* ) or all of ( $op* ) ) ) or ( 6 of them )
}

rule Unspecified_Malware_Oct16_C : hardened
{
	meta:
		description = "Detects an unspecififed malware - October 2016"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		author = "Florian Roth (Nextron Systems)"
		reference = "Internal Research"
		date = "2016-10-08"
		score = 80
		hash1 = "a451157f75627b2fef3d663946c94ef7dacb58f08b31d0ec4c0a542a1c4e6205"
		id = "fff98097-a19a-59aa-bece-837c75b0995c"

	strings:
		$s1 = {64 00 55 00 53 00 45 00 52 00 33 00 32 00 2e 00 44 00 4c 00 4c 00}
		$s2 = {6f 75 74 70 75 74 2e 64 6c 6c}

	condition:
		( uint16( 0 ) == 0x5a4d and filesize < 5000KB and all of them )
}

rule Bladabindi_Malware_B64 : hardened
{
	meta:
		description = "Detects Bladabindi Malware using Base64 encoded strings"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		author = "Florian Roth (Nextron Systems)"
		reference = "Internal Research"
		date = "2016-10-08"
		hash1 = "dda668b0792b7679979e61f2038cf9a8ec39415cc161be00d2c8301e7d48768d"
		id = "7f7023be-b6e1-5e1b-af8a-c413a5438ec8"

	strings:
		$s1 = {58 48 4e 35 63 33 52 6c 62 54 4d 79 58 41 3d 3d}
		$s2 = {52 58 68 6c 59 33 56 30 5a 53 42 46 55 6c 4a 50 55 67 3d 3d}
		$s3 = {64 48 4a 76 61 6d 46 75 4c 6d 56 34 5a 51 3d 3d}
		$s4 = {56 58 42 6b 59 58 52 6c 49 45 56 53 55 6b 39 53}
		$s5 = {52 47 39 33 62 6d 78 76 59 57 51 67 52 56 4a 53 54 31 49 3d}

	condition:
		uint16( 0 ) == 0x5a4d and filesize < 700KB and 1 of them
}

rule Dorkbot_Injector_Malware : hardened
{
	meta:
		description = "Detects Darkbot Injector"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		author = "Florian Roth (Nextron Systems)"
		reference = "Internal Research"
		date = "2016-10-08"
		hash1 = "bc3c5ac7180c8ac21d6908d747aa6122154d2bb51bb99ff0e0b1c65088d275dc"
		id = "b32986fe-d6f1-55f2-8d50-bc348b52fb49"

	strings:
		$s1 = {45 6e 74 65 72 20 61 6e 20 69 6e 74 65 67 65 72 2c 20 61 20 72 65 61 6c 20 6e 75 6d 62 65 72 2c 20 61 20 63 68 61 72 61 63 74 65 72 20 61 6e 64 20 61 20 73 74 72 69 6e 67 20 3a 20}
		$s2 = {72 65 61 64 79 20 74 6f 20 66 69 6e 69 73 68}
		$s3 = {45 59 45 6e 70 77}
		$s4 = {73 6f 6d 65 77 68 65 72 65 20 69 20 62 65 6c 6f 6e 67}
		$s5 = {4e 6f 74 20 61 6c 6c 20 66 69 65 6c 64 73 20 77 65 72 65 20 61 73 73 69 67 6e 65 64}
		$s6 = {74 61 6b 65 20 64 6f 77 6e}
		$s7 = {72 65 61 6c 20 6e 75 6d 62 65 72 20 3d 20 25 66}

	condition:
		( uint16( 0 ) == 0x5a4d and filesize < 500KB and 6 of them )
}

rule Unspecified_Malware_Oct16_D : hardened
{
	meta:
		description = "Detects unspecified malware - October 2016"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		author = "Florian Roth (Nextron Systems)"
		reference = "Internal Research"
		date = "2016-10-08"
		hash1 = "cd5f3bc0176a6803093ffdea6a7442c416e0d2945b6903063d17f5bb8d17519d"
		id = "6908467c-1ed6-508d-9503-246dd26823e5"

	strings:
		$s1 = {43 00 3a 00 5c 00 66 00 69 00 6c 00 65 00 2e 00 65 00 78 00 65 00}
		$s2 = {6e 00 65 00 77 00 2e 00 65 00 78 00 65 00}
		$s3 = {70 61 73 73 77 6f 72 64 49 74 65 72 61 74 69 6f 6e 73}
		$op0 = { 10 00 12 00 1a 00 05 00 01 00 01 00 01 00 10 00 }
		$op1 = { 41 32 00 36 00 62 00 34 00 32 00 65 00 37 00 62 }
		$op2 = { 3c 4d 6f 64 75 6c 65 3e 00 6e 65 77 2e 65 78 65 }

	condition:
		uint16( 0 ) == 0x5a4d and filesize < 1000KB and ( all of ( $s* ) or all of ( $op* ) )
}

rule Unspecified_Malware_Oct16_E : hardened
{
	meta:
		description = "Detects unspecified Malware - October 2016"
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		author = "Florian Roth (Nextron Systems)"
		reference = "Internal Research"
		date = "2016-10-08"
		hash1 = "28093385130b61f22920c0ce6e56de1f2cd8eef589bebe2af31f36f51f2b4d01"
		id = "fffffe0c-e114-5648-96ea-dd692610e34c"

	strings:
		$s1 = {50 33 70 4f 52 74}
		$s2 = {6d 73 64 6f 77 6e 6c 64 2e 74 6d 70}
		$s3 = {54 4d 50 34 33 35 31 24 2e 54 4d 50}

	condition:
		( uint16( 0 ) == 0x5a4d and filesize < 1000KB and all of them )
}

