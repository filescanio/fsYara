rule SUSP_LNX_Linux_Malware_Indicators_Aug20_1 : hardened
{
	meta:
		description = "Detects indicators often found in linux malware samples"
		author = "Florian Roth (Nextron Systems)"
		score = 50
		reference = "Internal Research"
		date = "2020-08-03"
		id = "9a1093a6-0239-5d1c-aa30-1ca725941583"

	strings:
		$s1 = {26 26 20 63 68 6d 6f 64 20 2b 78}
		$s2 = {7c 62 61 73 65 36 34 20 2d}
		$s3 = {20 2f 74 6d 70}
		$s4 = {7c 63 75 72 6c 20}
		$s5 = {77 68 6f 61 6d 69}
		$fp1 = {57 49 54 48 4f 55 54 20 41 4e 59 20 57 41 52 52 41 4e 54 59}
		$fp2 = {70 6f 73 74 69 6e 73 74}
		$fp3 = {54 48 49 53 20 53 4f 46 54 57 41 52 45 20 49 53 20 50 52 4f 56 49 44 45 44}
		$fp4 = {46 72 65 65 20 53 6f 66 74 77 61 72 65 20 46 6f 75 6e 64 61 74 69 6f 6e}

	condition:
		filesize < 400KB and 3 of ( $s* ) and not 1 of ( $fp* )
}

